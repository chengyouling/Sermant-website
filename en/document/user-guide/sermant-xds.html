<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Proxyless Service Mesh Based on Sermant and Istio | Sermant</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/img/logo.svg">
    <meta name="description" content="A Proxyless Service Mesh based on Bytecode Enhancement">
    
    <link rel="preload" href="/assets/css/0.styles.aea4a1e9.css" as="style"><link rel="preload" href="/assets/js/app.7283d6fb.js" as="script"><link rel="preload" href="/assets/js/3.06f127bc.js" as="script"><link rel="preload" href="/assets/js/1.c8bacf5b.js" as="script"><link rel="preload" href="/assets/js/64.ba4db5b6.js" as="script"><link rel="preload" href="/assets/js/14.199c38f6.js" as="script"><link rel="prefetch" href="/assets/js/10.11126491.js"><link rel="prefetch" href="/assets/js/100.fe565a9f.js"><link rel="prefetch" href="/assets/js/101.75a964a5.js"><link rel="prefetch" href="/assets/js/102.f5b8826b.js"><link rel="prefetch" href="/assets/js/103.70f393c3.js"><link rel="prefetch" href="/assets/js/104.8f53fb0c.js"><link rel="prefetch" href="/assets/js/105.3812faf4.js"><link rel="prefetch" href="/assets/js/106.164f80b3.js"><link rel="prefetch" href="/assets/js/107.da9f194b.js"><link rel="prefetch" href="/assets/js/108.6f001d15.js"><link rel="prefetch" href="/assets/js/109.d0427332.js"><link rel="prefetch" href="/assets/js/11.592204d9.js"><link rel="prefetch" href="/assets/js/110.e66395e3.js"><link rel="prefetch" href="/assets/js/111.bc0af18c.js"><link rel="prefetch" href="/assets/js/112.303db773.js"><link rel="prefetch" href="/assets/js/113.4a55a566.js"><link rel="prefetch" href="/assets/js/114.ad07dce3.js"><link rel="prefetch" href="/assets/js/115.6145b589.js"><link rel="prefetch" href="/assets/js/12.fd6a031f.js"><link rel="prefetch" href="/assets/js/13.7427e98b.js"><link rel="prefetch" href="/assets/js/15.900a8374.js"><link rel="prefetch" href="/assets/js/16.dc00a508.js"><link rel="prefetch" href="/assets/js/17.7bb9b1f6.js"><link rel="prefetch" href="/assets/js/18.0cb1c621.js"><link rel="prefetch" href="/assets/js/19.f3f80c20.js"><link rel="prefetch" href="/assets/js/20.341a6ad9.js"><link rel="prefetch" href="/assets/js/21.5cb4b5ea.js"><link rel="prefetch" href="/assets/js/22.9fae982b.js"><link rel="prefetch" href="/assets/js/23.c7c78153.js"><link rel="prefetch" href="/assets/js/24.d862bfe2.js"><link rel="prefetch" href="/assets/js/25.d2bfc810.js"><link rel="prefetch" href="/assets/js/26.fe2d3037.js"><link rel="prefetch" href="/assets/js/27.09e84572.js"><link rel="prefetch" href="/assets/js/28.2400a5c0.js"><link rel="prefetch" href="/assets/js/29.b0ddb50b.js"><link rel="prefetch" href="/assets/js/30.0da55062.js"><link rel="prefetch" href="/assets/js/31.5a0cda15.js"><link rel="prefetch" href="/assets/js/32.091bfc64.js"><link rel="prefetch" href="/assets/js/33.56d800c8.js"><link rel="prefetch" href="/assets/js/34.d8960a15.js"><link rel="prefetch" href="/assets/js/35.4d936c34.js"><link rel="prefetch" href="/assets/js/36.69b2f3fb.js"><link rel="prefetch" href="/assets/js/37.f1740a13.js"><link rel="prefetch" href="/assets/js/38.c2bf7b2d.js"><link rel="prefetch" href="/assets/js/39.13bbacce.js"><link rel="prefetch" href="/assets/js/4.7add7152.js"><link rel="prefetch" href="/assets/js/40.52b4d8d7.js"><link rel="prefetch" href="/assets/js/41.ee37f503.js"><link rel="prefetch" href="/assets/js/42.c6aa5076.js"><link rel="prefetch" href="/assets/js/43.40e880d7.js"><link rel="prefetch" href="/assets/js/44.7f56be52.js"><link rel="prefetch" href="/assets/js/45.e8a925fc.js"><link rel="prefetch" href="/assets/js/46.a1c61b6e.js"><link rel="prefetch" href="/assets/js/47.4f0a114b.js"><link rel="prefetch" href="/assets/js/48.2ddc52bc.js"><link rel="prefetch" href="/assets/js/49.0d4508d4.js"><link rel="prefetch" href="/assets/js/5.4a333fb7.js"><link rel="prefetch" href="/assets/js/50.e52baf42.js"><link rel="prefetch" href="/assets/js/51.323b9617.js"><link rel="prefetch" href="/assets/js/52.346fa80a.js"><link rel="prefetch" href="/assets/js/53.9cfa5608.js"><link rel="prefetch" href="/assets/js/54.910bbc3e.js"><link rel="prefetch" href="/assets/js/55.592a2d6d.js"><link rel="prefetch" href="/assets/js/56.dc709143.js"><link rel="prefetch" href="/assets/js/57.b682688b.js"><link rel="prefetch" href="/assets/js/58.3b83140b.js"><link rel="prefetch" href="/assets/js/59.255861a7.js"><link rel="prefetch" href="/assets/js/6.72029eac.js"><link rel="prefetch" href="/assets/js/60.f1229caf.js"><link rel="prefetch" href="/assets/js/61.292a52c9.js"><link rel="prefetch" href="/assets/js/62.97ede56c.js"><link rel="prefetch" href="/assets/js/63.f049854f.js"><link rel="prefetch" href="/assets/js/65.5917e76d.js"><link rel="prefetch" href="/assets/js/66.e7547192.js"><link rel="prefetch" href="/assets/js/67.6bbfea50.js"><link rel="prefetch" href="/assets/js/68.df035518.js"><link rel="prefetch" href="/assets/js/69.2e143b01.js"><link rel="prefetch" href="/assets/js/7.698dd478.js"><link rel="prefetch" href="/assets/js/70.d0d9e386.js"><link rel="prefetch" href="/assets/js/71.bcdac895.js"><link rel="prefetch" href="/assets/js/72.9490e30b.js"><link rel="prefetch" href="/assets/js/73.9afc2fcf.js"><link rel="prefetch" href="/assets/js/74.cc2dec6d.js"><link rel="prefetch" href="/assets/js/75.83cc918a.js"><link rel="prefetch" href="/assets/js/76.fcbe5122.js"><link rel="prefetch" href="/assets/js/77.6073f5b0.js"><link rel="prefetch" href="/assets/js/78.6b7eb13a.js"><link rel="prefetch" href="/assets/js/79.9e1e5534.js"><link rel="prefetch" href="/assets/js/8.10750ce9.js"><link rel="prefetch" href="/assets/js/80.a56d59b3.js"><link rel="prefetch" href="/assets/js/81.d4686ffc.js"><link rel="prefetch" href="/assets/js/82.4d9eb05e.js"><link rel="prefetch" href="/assets/js/83.00474326.js"><link rel="prefetch" href="/assets/js/84.91df4c67.js"><link rel="prefetch" href="/assets/js/85.d0ba9718.js"><link rel="prefetch" href="/assets/js/86.66fae153.js"><link rel="prefetch" href="/assets/js/87.b2fa207d.js"><link rel="prefetch" href="/assets/js/88.92620478.js"><link rel="prefetch" href="/assets/js/89.2d3fa404.js"><link rel="prefetch" href="/assets/js/9.7f57e4b0.js"><link rel="prefetch" href="/assets/js/90.6e8c155e.js"><link rel="prefetch" href="/assets/js/91.7bbdd4d6.js"><link rel="prefetch" href="/assets/js/92.9b2f5bd1.js"><link rel="prefetch" href="/assets/js/93.3e4d239e.js"><link rel="prefetch" href="/assets/js/94.9cb9cb55.js"><link rel="prefetch" href="/assets/js/95.b4387d26.js"><link rel="prefetch" href="/assets/js/96.7a2c2952.js"><link rel="prefetch" href="/assets/js/97.82e4da43.js"><link rel="prefetch" href="/assets/js/98.51ebe1cd.js"><link rel="prefetch" href="/assets/js/99.1d8e876a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.aea4a1e9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/en/" class="home-link router-link-active"><img src="/img/sermant-logo.png" alt="Sermant" class="logo"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/en/document/" class="nav-link">
  Document
</a></div><div class="nav-item"><a href="/en/blog/" class="nav-link">
  Blog
</a></div><div class="nav-item"><a href="https://github.com/sermant-io/Sermant" target="_blank" class="nav-link external">
  Github
  <!----></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Languages" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Languages" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/zh/document/user-guide/sermant-xds.html" class="nav-link">
  简体中文
</a></li><li class="dropdown-item"><!----> <a href="/en/document/user-guide/sermant-xds.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li></ul></div></div> <div class="nav-item"><!----></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/en/document/" class="nav-link">
  Document
</a></div><div class="nav-item"><a href="/en/blog/" class="nav-link">
  Blog
</a></div><div class="nav-item"><a href="https://github.com/sermant-io/Sermant" target="_blank" class="nav-link external">
  Github
  <!----></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Languages" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Languages" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/zh/document/user-guide/sermant-xds.html" class="nav-link">
  简体中文
</a></li><li class="dropdown-item"><!----> <a href="/en/document/user-guide/sermant-xds.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li></ul></div></div> <div class="nav-item"><!----></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Start</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>User Guide</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/en/document/user-guide/" aria-current="page" class="sidebar-link">Introduction to the use of Sermant</a></li><li><a href="/en/document/user-guide/sermant-agent.html" class="sidebar-link">Sermant Agent User Manual</a></li><li><a href="/en/document/user-guide/sermant-backend.html" class="sidebar-link">Sermant Backend User Manual</a></li><li><a href="/en/document/user-guide/configuration-center.html" class="sidebar-link">Dynamic Configuration Center User Manual</a></li><li><a href="/en/document/user-guide/sermant-xds.html" aria-current="page" class="active sidebar-link">Proxyless Service Mesh Based on Sermant and Istio</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/en/document/user-guide/sermant-xds.html#service-governance-of-sermant-in-istio-environment" class="sidebar-link">Service Governance of Sermant in Istio Environment</a></li><li class="sidebar-sub-header"><a href="/en/document/user-guide/sermant-xds.html#service-discovery-based-on-xds-service" class="sidebar-link">Service Discovery based on xDS Service</a></li><li class="sidebar-sub-header"><a href="/en/document/user-guide/sermant-xds.html#routing-based-on-xds-service" class="sidebar-link">Routing based on xDS Service</a></li><li class="sidebar-sub-header"><a href="/en/document/user-guide/sermant-xds.html#load-balancing-based-on-xds-service" class="sidebar-link">Load balancing based on xDS Service</a></li><li class="sidebar-sub-header"><a href="/en/document/user-guide/sermant-xds.html#startup-and-result-verification" class="sidebar-link">Startup and Result Verification</a></li></ul></li><li><a href="/en/document/user-guide/injector.html" class="sidebar-link">Sermant Injector User Manual</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Plugin Guide</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Developer Guide</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Community Guide</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>FAQ</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="proxyless-service-mesh-based-on-sermant-and-istio"><a href="#proxyless-service-mesh-based-on-sermant-and-istio" class="header-anchor">#</a> Proxyless Service Mesh Based on Sermant and Istio</h1> <h2 id="service-governance-of-sermant-in-istio-environment"><a href="#service-governance-of-sermant-in-istio-environment" class="header-anchor">#</a> Service Governance of Sermant in Istio Environment</h2> <p>A service mesh is an infrastructure layer that handles service-to-service communication. It reliably delivers requests through the complex service topology that constitutes modern cloud-native applications. In practice, service mesh is usually implemented as a lightweight array of network proxies, which are deployed alongside application code, without the application being aware of the presence of these proxies.</p> <p>Istio is currently the most widely used Service Mesh product, consisting of a control plane and a data plane. The data plane in Istio typically deploys separate sidecar containers to proxy microservices, resulting in additional performance overhead, including increased CPU usage and significant growth in service call latency. Additionally, this setup increases system complexity and the difficulty of operations and maintenance.</p> <p>The Sermant xDS service allows microservices to integrate with Istio in a Kubernetes environment. Sermant communicates directly with Istio's control plane based on the xDS protocol to obtain configuration information such as service discovery and routing, thereby replacing Envoy as Istio's data plane for service governance.</p> <p>Sermant is a cloud-native, proxyless service mesh based on a Java Agent. Microservices run Sermant in the same process, eliminating the need to start additional sidecar containers for network proxying. This significantly reduces application performance overhead and call latency between services.</p> <h3 id="istio-sermant-sidecar-proxyless-mode-deployment"><a href="#istio-sermant-sidecar-proxyless-mode-deployment" class="header-anchor">#</a> Istio+Sermant Sidecar Proxyless Mode Deployment</h3> <div class="el-image"><div class="el-image__placeholder"></div><!----></div> <ol><li>Mixed Deployment Mode: Coexistence of Sidecar Proxy Mode and Sidecar Proxyless Mode. Microservices connect to Istio and achieve service governance through a mixed deployment mode. This mode avoids modifying the existing deployment architecture, allowing only new services to use the Sidecar Proxyless Mode.</li> <li>Proxyless Deployment Mode: All microservices use Sermant as Istio's data plane to achieve capabilities such as service discovery、routing and load balancing. Sermant can replace the capabilities provided by Envoy, currently supporting service discovery, with more features to be developed in the future.</li></ol> <h3 id="advantages-of-using-sermant-in-istio-environment"><a href="#advantages-of-using-sermant-in-istio-environment" class="header-anchor">#</a> Advantages of using Sermant in Istio Environment</h3> <ol><li>Sermant runs in the same process as microservices, eliminating the need to start additional sidecar containers, significantly reducing network call latency and CPU overhead.</li> <li>Developing plugins based on the Sermant framework can achieve richer governance capabilities than Envoy, offering greater extensibility.</li> <li>Lower architectural complexity leads to reduced deployment costs.</li></ol> <h2 id="service-discovery-based-on-xds-service"><a href="#service-discovery-based-on-xds-service" class="header-anchor">#</a> Service Discovery based on xDS Service</h2> <p>The Sermant framework implements service discovery capabilities based on the xDS protocol. Plugins can call the xDS service discovery interface to obtain Kubernetes service instances. For detailed development guidance, please refer to <a href="/en/document/developer-guide/sermant-xds-service.html#service-discovery-based-on-xds-protocol">Service Discovery Development Guide Based on xDS Services</a>.</p> <h3 id="sermant-plugins-planned-to-support-xds-service-discovery"><a href="#sermant-plugins-planned-to-support-xds-service-discovery" class="header-anchor">#</a> Sermant Plugins Planned to Support xDS Service Discovery</h3> <ul><li><a href="/en/document/plugin/router.html">Router Plugin</a></li> <li><a href="/en/document/plugin/springboot-registry.html">SpringBoot Registry Plugin</a></li></ul> <h2 id="routing-based-on-xds-service"><a href="#routing-based-on-xds-service" class="header-anchor">#</a> Routing based on xDS Service</h2> <p>In the future, the Sermant framework will implement routing configuration retrieval capabilities based on the xDS protocol, which will be used for service governance at the plugin layer.</p> <h2 id="load-balancing-based-on-xds-service"><a href="#load-balancing-based-on-xds-service" class="header-anchor">#</a> Load balancing based on xDS Service</h2> <p>In the future, the Sermant framework will implement load balancing configuration retrieval capabilities based on the xDS protocol, which will be used for service governance at the plugin layer.</p> <h2 id="startup-and-result-verification"><a href="#startup-and-result-verification" class="header-anchor">#</a> Startup and Result Verification</h2> <p>This tutorial demonstrates the xDS service discovery capabilities of Sermant using the <a href="https://github.com/sermant-io/Sermant-examples/tree/main/xds-service-discovery-demo" target="_blank" rel="noopener noreferrer">Sermant-examples<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> repository's xds-service-discovery-demo.</p> <p>This demo includes a spring-client microservice, a spring-server microservice, and a Sermant example plugin. The plugin intercepts the <code>hello</code> method of the spring-client and uses Sermant's xDS service discovery capabilities to get specific instance information of the spring-server service before executing the <code>hello</code> method, replacing the input parameter with the correct spring-server address.</p> <h3 id="preparations"><a href="#preparations" class="header-anchor">#</a> Preparations</h3> <ul><li><a href="https://github.com/sermant-io/Sermant-examples/releases/download/v2.0.0/sermant-examples-xds-service-discovery-demo-2.0.0.tar.gz" target="_blank" rel="noopener noreferrer">Download<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> the binary package of the demo.</li> <li>Prepare the Kubernetes environment.</li> <li>Install Istio and start it.</li></ul> <h3 id="obtaining-the-demo-binary-package"><a href="#obtaining-the-demo-binary-package" class="header-anchor">#</a> Obtaining the Demo Binary Package</h3> <p>Extract the binary package to get the <code>product/</code> directory files.</p> <h3 id="starting-the-spring-server"><a href="#starting-the-spring-server" class="header-anchor">#</a> Starting the spring-server</h3> <p>Enter the product/spring-server directory:</p> <ol><li><p>Execute the following command to package the spring-server image:</p> <div class="language- extra-class"><pre class="language-text"><code>sh build-server.sh
</code></pre></div></li> <li><p>Execute the following command to run the spring-server pod and service:</p> <div class="language- extra-class"><pre class="language-text"><code>kubectl apply -f spring-server.yaml
</code></pre></div></li></ol> <h3 id="starting-the-spring-client"><a href="#starting-the-spring-client" class="header-anchor">#</a> Starting the spring-client</h3> <p>Enter the product/spring-client directory:</p> <ol><li><p>Execute the following command to package the spring-client image:</p> <div class="language- extra-class"><pre class="language-text"><code>sh build-client.sh
</code></pre></div></li> <li><p>Execute the following command to run the spring-client instance and service:</p> <div class="language- extra-class"><pre class="language-text"><code>kubectl apply -f spring-client.yaml
</code></pre></div></li></ol> <h3 id="verification"><a href="#verification" class="header-anchor">#</a> Verification</h3> <p>Access the spring-client microservice via a web page, set the input parameter <code>address</code> to empty, and verify whether Sermant can successfully call the upstream service spring-server:</p> <div class="language- extra-class"><pre class="language-text"><code>http://127.0.0.1:30110/hello?address=
</code></pre></div><p>The webpage shows the following message, indicating that Sermant successfully discovered the instance of spring-server and modified the <code>address</code> parameter to the correct spring-server instance address:</p> <div class="language- extra-class"><pre class="language-text"><code>Greetings from http://xxx.xxx.xxx.xxx:8080 : hello, the current time is 2050-01-01T02:08:08.369
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">9/12/2024, 2:34:52 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/en/document/user-guide/configuration-center.html" class="prev">
        Dynamic Configuration Center User Manual
      </a></span> <span class="next"><a href="/en/document/user-guide/injector.html">
        Sermant Injector User Manual
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.7283d6fb.js" defer></script><script src="/assets/js/3.06f127bc.js" defer></script><script src="/assets/js/1.c8bacf5b.js" defer></script><script src="/assets/js/64.ba4db5b6.js" defer></script><script src="/assets/js/14.199c38f6.js" defer></script>
  </body>
</html>
