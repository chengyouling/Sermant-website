<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Dynamic Configuration Center User Manual | Sermant</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/img/logo.svg">
    <meta name="description" content="A Proxyless Service Mesh based on Bytecode Enhancement">
    
    <link rel="preload" href="/assets/css/0.styles.aea4a1e9.css" as="style"><link rel="preload" href="/assets/js/app.7283d6fb.js" as="script"><link rel="preload" href="/assets/js/3.06f127bc.js" as="script"><link rel="preload" href="/assets/js/1.c8bacf5b.js" as="script"><link rel="preload" href="/assets/js/59.255861a7.js" as="script"><link rel="preload" href="/assets/js/14.199c38f6.js" as="script"><link rel="prefetch" href="/assets/js/10.11126491.js"><link rel="prefetch" href="/assets/js/100.fe565a9f.js"><link rel="prefetch" href="/assets/js/101.75a964a5.js"><link rel="prefetch" href="/assets/js/102.f5b8826b.js"><link rel="prefetch" href="/assets/js/103.70f393c3.js"><link rel="prefetch" href="/assets/js/104.8f53fb0c.js"><link rel="prefetch" href="/assets/js/105.3812faf4.js"><link rel="prefetch" href="/assets/js/106.164f80b3.js"><link rel="prefetch" href="/assets/js/107.da9f194b.js"><link rel="prefetch" href="/assets/js/108.6f001d15.js"><link rel="prefetch" href="/assets/js/109.d0427332.js"><link rel="prefetch" href="/assets/js/11.592204d9.js"><link rel="prefetch" href="/assets/js/110.e66395e3.js"><link rel="prefetch" href="/assets/js/111.bc0af18c.js"><link rel="prefetch" href="/assets/js/112.303db773.js"><link rel="prefetch" href="/assets/js/113.4a55a566.js"><link rel="prefetch" href="/assets/js/114.ad07dce3.js"><link rel="prefetch" href="/assets/js/115.6145b589.js"><link rel="prefetch" href="/assets/js/12.fd6a031f.js"><link rel="prefetch" href="/assets/js/13.7427e98b.js"><link rel="prefetch" href="/assets/js/15.900a8374.js"><link rel="prefetch" href="/assets/js/16.dc00a508.js"><link rel="prefetch" href="/assets/js/17.7bb9b1f6.js"><link rel="prefetch" href="/assets/js/18.0cb1c621.js"><link rel="prefetch" href="/assets/js/19.f3f80c20.js"><link rel="prefetch" href="/assets/js/20.341a6ad9.js"><link rel="prefetch" href="/assets/js/21.5cb4b5ea.js"><link rel="prefetch" href="/assets/js/22.9fae982b.js"><link rel="prefetch" href="/assets/js/23.c7c78153.js"><link rel="prefetch" href="/assets/js/24.d862bfe2.js"><link rel="prefetch" href="/assets/js/25.d2bfc810.js"><link rel="prefetch" href="/assets/js/26.fe2d3037.js"><link rel="prefetch" href="/assets/js/27.09e84572.js"><link rel="prefetch" href="/assets/js/28.2400a5c0.js"><link rel="prefetch" href="/assets/js/29.b0ddb50b.js"><link rel="prefetch" href="/assets/js/30.0da55062.js"><link rel="prefetch" href="/assets/js/31.5a0cda15.js"><link rel="prefetch" href="/assets/js/32.091bfc64.js"><link rel="prefetch" href="/assets/js/33.56d800c8.js"><link rel="prefetch" href="/assets/js/34.d8960a15.js"><link rel="prefetch" href="/assets/js/35.4d936c34.js"><link rel="prefetch" href="/assets/js/36.69b2f3fb.js"><link rel="prefetch" href="/assets/js/37.f1740a13.js"><link rel="prefetch" href="/assets/js/38.c2bf7b2d.js"><link rel="prefetch" href="/assets/js/39.13bbacce.js"><link rel="prefetch" href="/assets/js/4.7add7152.js"><link rel="prefetch" href="/assets/js/40.52b4d8d7.js"><link rel="prefetch" href="/assets/js/41.ee37f503.js"><link rel="prefetch" href="/assets/js/42.c6aa5076.js"><link rel="prefetch" href="/assets/js/43.40e880d7.js"><link rel="prefetch" href="/assets/js/44.7f56be52.js"><link rel="prefetch" href="/assets/js/45.e8a925fc.js"><link rel="prefetch" href="/assets/js/46.a1c61b6e.js"><link rel="prefetch" href="/assets/js/47.4f0a114b.js"><link rel="prefetch" href="/assets/js/48.2ddc52bc.js"><link rel="prefetch" href="/assets/js/49.0d4508d4.js"><link rel="prefetch" href="/assets/js/5.4a333fb7.js"><link rel="prefetch" href="/assets/js/50.e52baf42.js"><link rel="prefetch" href="/assets/js/51.323b9617.js"><link rel="prefetch" href="/assets/js/52.346fa80a.js"><link rel="prefetch" href="/assets/js/53.9cfa5608.js"><link rel="prefetch" href="/assets/js/54.910bbc3e.js"><link rel="prefetch" href="/assets/js/55.592a2d6d.js"><link rel="prefetch" href="/assets/js/56.dc709143.js"><link rel="prefetch" href="/assets/js/57.b682688b.js"><link rel="prefetch" href="/assets/js/58.3b83140b.js"><link rel="prefetch" href="/assets/js/6.72029eac.js"><link rel="prefetch" href="/assets/js/60.f1229caf.js"><link rel="prefetch" href="/assets/js/61.292a52c9.js"><link rel="prefetch" href="/assets/js/62.97ede56c.js"><link rel="prefetch" href="/assets/js/63.f049854f.js"><link rel="prefetch" href="/assets/js/64.ba4db5b6.js"><link rel="prefetch" href="/assets/js/65.5917e76d.js"><link rel="prefetch" href="/assets/js/66.e7547192.js"><link rel="prefetch" href="/assets/js/67.6bbfea50.js"><link rel="prefetch" href="/assets/js/68.df035518.js"><link rel="prefetch" href="/assets/js/69.2e143b01.js"><link rel="prefetch" href="/assets/js/7.698dd478.js"><link rel="prefetch" href="/assets/js/70.d0d9e386.js"><link rel="prefetch" href="/assets/js/71.bcdac895.js"><link rel="prefetch" href="/assets/js/72.9490e30b.js"><link rel="prefetch" href="/assets/js/73.9afc2fcf.js"><link rel="prefetch" href="/assets/js/74.cc2dec6d.js"><link rel="prefetch" href="/assets/js/75.83cc918a.js"><link rel="prefetch" href="/assets/js/76.fcbe5122.js"><link rel="prefetch" href="/assets/js/77.6073f5b0.js"><link rel="prefetch" href="/assets/js/78.6b7eb13a.js"><link rel="prefetch" href="/assets/js/79.9e1e5534.js"><link rel="prefetch" href="/assets/js/8.10750ce9.js"><link rel="prefetch" href="/assets/js/80.a56d59b3.js"><link rel="prefetch" href="/assets/js/81.d4686ffc.js"><link rel="prefetch" href="/assets/js/82.4d9eb05e.js"><link rel="prefetch" href="/assets/js/83.00474326.js"><link rel="prefetch" href="/assets/js/84.91df4c67.js"><link rel="prefetch" href="/assets/js/85.d0ba9718.js"><link rel="prefetch" href="/assets/js/86.66fae153.js"><link rel="prefetch" href="/assets/js/87.b2fa207d.js"><link rel="prefetch" href="/assets/js/88.92620478.js"><link rel="prefetch" href="/assets/js/89.2d3fa404.js"><link rel="prefetch" href="/assets/js/9.7f57e4b0.js"><link rel="prefetch" href="/assets/js/90.6e8c155e.js"><link rel="prefetch" href="/assets/js/91.7bbdd4d6.js"><link rel="prefetch" href="/assets/js/92.9b2f5bd1.js"><link rel="prefetch" href="/assets/js/93.3e4d239e.js"><link rel="prefetch" href="/assets/js/94.9cb9cb55.js"><link rel="prefetch" href="/assets/js/95.b4387d26.js"><link rel="prefetch" href="/assets/js/96.7a2c2952.js"><link rel="prefetch" href="/assets/js/97.82e4da43.js"><link rel="prefetch" href="/assets/js/98.51ebe1cd.js"><link rel="prefetch" href="/assets/js/99.1d8e876a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.aea4a1e9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/en/" class="home-link router-link-active"><img src="/img/sermant-logo.png" alt="Sermant" class="logo"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/en/document/" class="nav-link">
  Document
</a></div><div class="nav-item"><a href="/en/blog/" class="nav-link">
  Blog
</a></div><div class="nav-item"><a href="https://github.com/sermant-io/Sermant" target="_blank" class="nav-link external">
  Github
  <!----></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Languages" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Languages" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/zh/document/user-guide/configuration-center.html" class="nav-link">
  简体中文
</a></li><li class="dropdown-item"><!----> <a href="/en/document/user-guide/configuration-center.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li></ul></div></div> <div class="nav-item"><!----></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/en/document/" class="nav-link">
  Document
</a></div><div class="nav-item"><a href="/en/blog/" class="nav-link">
  Blog
</a></div><div class="nav-item"><a href="https://github.com/sermant-io/Sermant" target="_blank" class="nav-link external">
  Github
  <!----></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Languages" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Languages" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/zh/document/user-guide/configuration-center.html" class="nav-link">
  简体中文
</a></li><li class="dropdown-item"><!----> <a href="/en/document/user-guide/configuration-center.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li></ul></div></div> <div class="nav-item"><!----></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Start</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>User Guide</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/en/document/user-guide/" aria-current="page" class="sidebar-link">Introduction to the use of Sermant</a></li><li><a href="/en/document/user-guide/sermant-agent.html" class="sidebar-link">Sermant Agent User Manual</a></li><li><a href="/en/document/user-guide/sermant-backend.html" class="sidebar-link">Sermant Backend User Manual</a></li><li><a href="/en/document/user-guide/configuration-center.html" aria-current="page" class="active sidebar-link">Dynamic Configuration Center User Manual</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/en/document/user-guide/configuration-center.html#dynamic-configuration-center-in-sermant-scene-and-positioning" class="sidebar-link">Dynamic Configuration Center in Sermant Scene and Positioning</a></li><li class="sidebar-sub-header"><a href="/en/document/user-guide/configuration-center.html#parameter-configuration" class="sidebar-link">Parameter Configuration</a></li><li class="sidebar-sub-header"><a href="/en/document/user-guide/configuration-center.html#sermant-dynamic-configuration-center-model" class="sidebar-link">Sermant Dynamic Configuration Center Model</a></li><li class="sidebar-sub-header"><a href="/en/document/user-guide/configuration-center.html#sermant-implementation-of-configuration-model-based-on-different-dynamic-configuration-centers" class="sidebar-link">Sermant Implementation of Configuration Model Based on Different Dynamic Configuration Centers</a></li><li class="sidebar-sub-header"><a href="/en/document/user-guide/configuration-center.html#configuration-center-and-version-supported" class="sidebar-link">Configuration Center and Version Supported</a></li><li class="sidebar-sub-header"><a href="/en/document/user-guide/configuration-center.html#startup-and-result-validation" class="sidebar-link">Startup and Result Validation</a></li></ul></li><li><a href="/en/document/user-guide/sermant-xds.html" class="sidebar-link">Proxyless Service Mesh Based on Sermant and Istio</a></li><li><a href="/en/document/user-guide/injector.html" class="sidebar-link">Sermant Injector User Manual</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Plugin Guide</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Developer Guide</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Community Guide</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>FAQ</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="dynamic-configuration-center-user-manual"><a href="#dynamic-configuration-center-user-manual" class="header-anchor">#</a> Dynamic Configuration Center User Manual</h1> <p>This paper introduces the scenario model of Dynamic Configuration Center in Sermant and how to use it.</p> <h2 id="dynamic-configuration-center-in-sermant-scene-and-positioning"><a href="#dynamic-configuration-center-in-sermant-scene-and-positioning" class="header-anchor">#</a> Dynamic Configuration Center in Sermant Scene and Positioning</h2> <p>The dynamic configuration center is a supporting component for the dynamic configuration function of Sermant, which allows Sermant to dynamically pull configuration from the configuration center to achieve a variety of service governance capabilities. Users can enable dynamic configuration capabilities and deploy dynamic configuration centers on demand.</p> <p>Configuration center makes Sermant have the key ability of dynamic configuration on the basis of static configuration, and solves the problem of immutable configuration provided by the former, which is the implementation basis of service management diversification in Sermant. For example,</p> <ul><li><p>In the flowcontrol plugin, the configuration and delivery of traffic marking and flow control rules are realized by Sermant dynamic configuration and configuration center as the medium to achieve dynamic flow control.</p></li> <li><p>In the routing plugin, the configuration of label routing rules is also effective through this configuration center capability.</p></li></ul> <p>There are many mature open source products in the field of real-time configuration center and Sermant does not provide a single implementation of configuration center, but integrates the open source configuration center to achieve the business goal of real-time dynamic configuration of service governance rules.</p> <p>In the concrete implementation, sermant-agent defines a set of general interfaces for dynamic configuration. Based on this architecture,</p> <ul><li>The user determines the type of configuration center that the Sermant actually connects to through the configuration of the sermant-agent. It is also possible to directly operate the dynamic configuration center in the operation and maintenance scenario according to the manual of each service governance plugin to achieve the business goal of dynamic configuration.</li> <li>In the development of plugins, developers only need the common interface of Sermant dynamic configuration to realize the function of dynamic configuration, and do not need to pay attention to the selection and implementation of the dynamic configuration center itself.</li></ul> <p>The following architecture diagram illustrates the principle of the architecture.</p> <div class="el-image"><div class="el-image__placeholder"></div><!----></div> <h2 id="parameter-configuration"><a href="#parameter-configuration" class="header-anchor">#</a> Parameter Configuration</h2> <p>For configuration of the dynamic configuration center, see the corresponding open source dynamic configuration center
(<a href="https://zookeeper.apache.org/releases.html" target="_blank" rel="noopener noreferrer">ZooKeeper<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> , <a href="https://servicecomb.apache.org/cn/release/kie-downloads/" target="_blank" rel="noopener noreferrer">ServiceComb Kie<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, <a href="https://github.com/alibaba/nacos/releases" target="_blank" rel="noopener noreferrer">Nacos<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>). We will not go into details in
this paper.</p> <p>First, configure <code>agent.service.dynamic.config.enable=true</code> in <a href="/en/document/user-guide/sermant-agent.html#parameters-related-to-agent-framework">Parameters Related to Agent Framework of Sermant-agent User Manual</a> to <strong>enable dynamic configuration service</strong>.</p> <p>Second, you can configure parameters for dynamic configuration center of sermant-agent in <code>agent/config/config.properties</code> of sermant-agent product package. For specific parameters, please refer to <a href="/en/document/user-guide/sermant-agent.html#parameters-related-to-dynamic-configuration-center">Parameters Related to Dynamic Configuration Center of Sermant-agent User Manual</a>.</p> <h2 id="sermant-dynamic-configuration-center-model"><a href="#sermant-dynamic-configuration-center-model" class="header-anchor">#</a> Sermant Dynamic Configuration Center Model</h2> <p>以sermant-agent中的<a href="https://github.com/sermant-io/Sermant/blob/develop/sermant-agentcore/sermant-agentcore-core/src/main/java/io/sermant/core/service/dynamicconfig/api/KeyGroupService.java" target="_blank" rel="noopener noreferrer">KeyGroupService.publishConfig<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>接口函数说明Sermant中的配置模型。</p> <p>The configuration model in Sermant is illustrated by the interface function <a href="https://github.com/sermant-io/Sermant/blob/develop/sermant-agentcore/sermant-agentcore-core/src/main/java/io/sermant/core/service/dynamicconfig/api/KeyGroupService.java" target="_blank" rel="noopener noreferrer">KeyGroupService.publishConfig<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> in sermant-agent.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * Sets the configuration value for a key under the group
 *
 * @param key     key
 * @param group   group
 * @param content configuration value
 * @return success
 */</span>
<span class="token keyword">boolean</span> <span class="token function">publishConfig</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">String</span> group<span class="token punctuation">,</span> <span class="token class-name">String</span> content<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>As you can see in the example above, the two parameters used to determine the configuration in sermant-agent are:</p> <ul><li><code>key</code>: the key value of the smallest configuration unit。</li> <li><code>group</code>: group, like a prefix for <code>key</code>. Sermant mainly uses the group to be related with some configuration center tenant isolation function。</li></ul> <p>For different configuration centers, there are different matching models for group and key. This is explained in detail below.</p> <p>For users, to use the dynamic configuration center, you need to obtain the instance of <code>DynamicConfigService</code> in the development process of the plugin, and call various abstract interfaces provided by <code>DynamicConfigService</code> according to their own scenarios to perform corresponding service governance. You can refer to <a href="https://sermant.io/zh/document/developer-guide/dev-complex-plugin.html#%E5%8A%A8%E6%80%81%E9%85%8D%E7%BD%AE%E5%8A%9F%E8%83%BD" target="_blank" rel="noopener noreferrer">plugin function development related chapters<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for detailed API interface parsing and development guide.</p> <h2 id="sermant-implementation-of-configuration-model-based-on-different-dynamic-configuration-centers"><a href="#sermant-implementation-of-configuration-model-based-on-different-dynamic-configuration-centers" class="header-anchor">#</a> Sermant Implementation of Configuration Model Based on Different Dynamic Configuration Centers</h2> <p>The following sections discuss several typical implementations of configuration centers. By understanding the implementation of the model, users can understand how to find the corresponding configuration items in different configuration centers and how to configure them dynamically to achieve the goal of service governance management.</p> <h3 id="implementation-of-configuration-model-based-on-zookeeper"><a href="#implementation-of-configuration-model-based-on-zookeeper" class="header-anchor">#</a> Implementation of Configuration Model Based on Zookeeper</h3> <p>For <code>ZooKeeper</code> servers, the dynamic configuration is the value of the ZooKeeper node. The <code>Key</code> and <code>Group</code> should be used as elements to build the <strong>node path</strong>. Since <code>Group</code> contains user-specific information, it should be the prefix string for the <strong>node path</strong> so that the <code>Key</code> value exists as the second half:</p> <div class="language-txt extra-class"><pre class="language-txt"><code>/${group}/${key} -&gt; ${value}
</code></pre></div><h3 id="implementation-of-configuration-model-based-on-servicecomb-kie"><a href="#implementation-of-configuration-model-based-on-servicecomb-kie" class="header-anchor">#</a> <strong>Implementation of Configuration Model Based on ServiceComb Kie</strong></h3> <p>For the <code>Kie</code> service, the so-called dynamic configuration is the value of the <code>Kie'</code> configuration. <code>Kie</code> queries the associated configuration based on the label. <code>Key</code> and <code>Group</code> are the elements of the associated configuration. <code>Key</code> is the name of the configured Key, and <code>Group</code> is the label of the associated Key. Each <code>Key</code> can be configured with one or more labels. The format is usually as follows:</p> <div class="language-properties extra-class"><pre class="language-properties"><code>{
<span class="token key attr-name">  &quot;key&quot;</span><span class="token punctuation">:</span> <span class="token value attr-value">&quot;keyName&quot;,                # key</span>
<span class="token key attr-name">  &quot;value&quot;</span><span class="token punctuation">:</span> <span class="token value attr-value">&quot;value&quot;,                # value</span>
<span class="token key attr-name">  &quot;labels&quot;</span><span class="token punctuation">:</span> <span class="token value attr-value">{</span>
<span class="token key attr-name">    &quot;service&quot;</span><span class="token punctuation">:</span> <span class="token value attr-value">&quot;serviceName&quot;     #labels, kv form and support multiple labels</span>
  },
<span class="token key attr-name">  &quot;status&quot;</span><span class="token punctuation">:</span> <span class="token value attr-value">&quot;enabled&quot;</span>
}
</code></pre></div><p>Compared with <code>Zookeeper</code>, <code>Kie</code> is more focused on <code>Group</code> and its value transfer format is different. The value transfer format of <code>Kie</code> is as follows:</p> <div class="language-txt extra-class"><pre class="language-txt"><code>groupKey1=groupValue1[&amp;groupKey2=groupVaue2...]
</code></pre></div><blockquote><p><code>groupKey</code> is the key of label, <code>groupValue</code> is the value of label. Multiple labels are spliced by <code>&amp;</code>. <code>Group</code> could be  generated by LabelGroupUtils.</p> <p><strong>NOTE：</strong></p> <p>​	If the input <code>Group</code> is not in the above format, the label <code>Group=input Group</code> will be added by default.</p></blockquote> <h3 id="implementation-of-configuration-model-based-on-nacos"><a href="#implementation-of-configuration-model-based-on-nacos" class="header-anchor">#</a> Implementation of configuration model based on Nacos</h3> <p>In the case of the <code>Nacos</code>, dynamic configuration refers to the configuration values of the <code>Nacos</code>. <code>Nacos</code>
contains the <code>namespaceId</code>, <code>group</code> and <code>dataId</code>. The <code>namespaceId</code> default values is <code>service.meta.project</code> in
<code>agent/config/config.properties</code>. For specific parameters, please refer to <a href="/en/document/user-guide/sermant-agent.html#parameters-related-to-dynamic-configuration-center">Parameters Related to Dynamic Configuration Center of Sermant-agent User Manual</a>; The <code>group</code> is aligned with the Dynamic Configuration Center's <code>group</code>; <code>dataId</code> is set to the <code>Key</code> of the Dynamic Configuration Center, which is the key name of the configuration. The format is as follows:</p> <div class="language-properties extra-class"><pre class="language-properties"><code>{
<span class="token key attr-name">    &quot;group&quot;</span><span class="token punctuation">:</span> <span class="token value attr-value">&quot;Group&quot;, 			# group</span>
<span class="token key attr-name">    &quot;dataId&quot;</span><span class="token punctuation">:</span> <span class="token value attr-value">&quot;Key&quot;,  			# key</span>
<span class="token key attr-name">    &quot;content&quot;</span><span class="token punctuation">:</span> <span class="token value attr-value">&quot;config&quot;, 		# value</span>
<span class="token key attr-name">    &quot;namespaceId&quot;</span><span class="token punctuation">:</span> <span class="token value attr-value">&quot;default&quot;	# namespace</span>
}
</code></pre></div><p>The naming format requirements for <code>group</code> and <code>dataId</code> are as follows, please refer to the <a href="https://nacos.io/zh-cn/docs/sdk.html" target="_blank" rel="noopener noreferrer">Nacos documentation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>:</p> <ul><li><code>dataId</code> use alphabetical letters and these four special characters (&quot;.&quot;, &quot;:&quot;, &quot;-&quot;, &quot;_&quot;) only. Up to 256 characters
are allowed.</li> <li><code>group</code> use alphabetical letters and these four special characters (&quot;.&quot;, &quot;:&quot;, &quot;-&quot;, &quot;_&quot;) only. Up to 128 characters
are allowed.</li></ul> <blockquote><p><strong>Special note:</strong></p> <p>If the passed <code>group</code> contains three kinds of illegal characters: <code>=</code>、<code>&amp;</code> and <code>/</code>, the dynamic configuration core will automatically convert it to legal characters:
<code>=</code> to <code>:</code>,<code>&amp;</code> to <code>_</code> and <code>/</code> to<code>.</code>。</p></blockquote> <h2 id="configuration-center-and-version-supported"><a href="#configuration-center-and-version-supported" class="header-anchor">#</a> Configuration Center and Version Supported</h2> <p>The configuration center components currently supported by Sermant are:</p> <ul><li><a href="https://zookeeper.apache.org/releases.html" target="_blank" rel="noopener noreferrer">ZooKeeper<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, version 3.6.3.</li> <li><a href="https://servicecomb.apache.org/cn/release/kie-downloads/" target="_blank" rel="noopener noreferrer">ServiceComb Kie<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, version 0.2.0.</li> <li><a href="https://github.com/alibaba/nacos/releases" target="_blank" rel="noopener noreferrer">Nacos<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, version 2.1.0.</li></ul> <h2 id="startup-and-result-validation"><a href="#startup-and-result-validation" class="header-anchor">#</a> Startup and Result Validation</h2> <p>This document uses the demo plugin in <a href="https://github.com/sermant-io/Sermant-examples/tree/main/sermant-template/template" target="_blank" rel="noopener noreferrer">Sermant-examples<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> to demonstrate dynamic configuration capability, whose implementation adds a listener to listen for dynamic configuration changes.</p> <h3 id="zookeeper"><a href="#zookeeper" class="header-anchor">#</a> Zookeeper</h3> <h4 id="startup"><a href="#startup" class="header-anchor">#</a> Startup</h4> <p>First, start the configuration center Zookeeper. You can learn how to deployment it by official information.</p> <p>Then refer to the <a href="/en/document/user-guide/sermant-agent.html">Sermant-agent User Manual</a> startup and result verification section to start the host application mounting sermant-agent.</p> <h4 id="publish-configuration"><a href="#publish-configuration" class="header-anchor">#</a> Publish Configuration</h4> <p>Use the Zookeeper command-line tool or visualization tool to publish configuration. Using a command-line tool as an example, enter the following command:</p> <div class="language-shell extra-class"><pre class="language-shell"><code>create /app<span class="token operator">=</span>default/demo <span class="token string">&quot;test&quot;</span>
</code></pre></div><p>Where <code>app=default</code> is the group, <code>demo</code> is the key, and <code>test</code> is the value.</p> <p>When the node data is successfully created, the dynamic configuration is successfully published in the configuration center.</p> <h4 id="validation"><a href="#validation" class="header-anchor">#</a> Validation</h4> <p>Check out the sermant log file sermant-0.log. The default log file path is <code>./logs/sermant/core</code>.</p> <p>Observe if the log file contains the following log output:</p> <div class="language- extra-class"><pre class="language-text"><code>[DemoDynaConfService]-DynamicConfigEvent{key='demo', group='app=default', content='test', eventType=CREATE} io.sermant.core.service.dynamicconfig.common.DynamicConfigEvent[source=demo,app=default]
</code></pre></div><p>If the log output is correct, it means that the dynamic configuration is published successfully and the sermant-agent has listened to the dynamic configuration.</p> <h3 id="kie"><a href="#kie" class="header-anchor">#</a> Kie</h3> <p>Kie is used in a similar way to Zoopeepr, with the only difference that publishing configuration is performed in the way of Kie.</p> <h4 id="startup-2"><a href="#startup-2" class="header-anchor">#</a> Startup</h4> <p>First, start the configuration center Kie. You can learn how to deployment it by official information.</p> <p>Then refer to the <a href="/en/document/user-guide/sermant-agent.html">Sermant-agent User Manual</a> startup and result verification section to start the host application mounting sermant-agent.</p> <h4 id="publish-configuration-2"><a href="#publish-configuration-2" class="header-anchor">#</a> Publish Configuration</h4> <p>Publish the following dynamic configuration via Kie:</p> <div class="language-properties extra-class"><pre class="language-properties"><code>{
<span class="token key attr-name">  &quot;key&quot;</span><span class="token punctuation">:</span> <span class="token value attr-value">&quot;demo&quot;,          </span>
<span class="token key attr-name">  &quot;value&quot;</span><span class="token punctuation">:</span> <span class="token value attr-value">&quot;test&quot;,              </span>
<span class="token key attr-name">  &quot;labels&quot;</span><span class="token punctuation">:</span> <span class="token value attr-value">{</span>
<span class="token key attr-name">    &quot;app&quot;</span><span class="token punctuation">:</span> <span class="token value attr-value">&quot;default&quot;     </span>
  },
<span class="token key attr-name">  &quot;status&quot;</span><span class="token punctuation">:</span> <span class="token value attr-value">&quot;enabled&quot;</span>
}
</code></pre></div><p>Where <code>app=default</code> is the group, <code>demo</code> is the key, and <code>test</code> is the value.</p> <p>When the node data is successfully created, the dynamic configuration is successfully published in the configuration center.</p> <h4 id="validation-2"><a href="#validation-2" class="header-anchor">#</a> Validation</h4> <p>Check out the sermant log file sermant-0.log. The default log file path is <code>./logs/sermant/core</code>.</p> <p>Observe if the log file contains the following log output:</p> <div class="language- extra-class"><pre class="language-text"><code>[DemoDynaConfService]-DynamicConfigEvent{key='demo', group='app=default', content='test', eventType=CREATE} io.sermant.core.service.dynamicconfig.common.DynamicConfigEvent[source=demo,app=default]
</code></pre></div><p>If the log output is correct, it means that the dynamic configuration is published successfully and the sermant-agent has listened to the dynamic configuration.</p> <h3 id="nacos"><a href="#nacos" class="header-anchor">#</a> Nacos</h3> <p>Nacos is used in a similar way to Zoopeepr and Kie, with the only difference that publishing configuration is
performed in the way of Nacos.</p> <h4 id="startup-3"><a href="#startup-3" class="header-anchor">#</a> Startup</h4> <p>First, start the configuration center Nacos. You can learn how to deployment it by official information.</p> <p>Then refer to the <a href="/en/document/user-guide/sermant-agent.html">Sermant-agent User Manual</a> startup and result verification section to start the host application mounting sermant-agent.</p> <h4 id="publish-configuration-3"><a href="#publish-configuration-3" class="header-anchor">#</a> Publish Configuration</h4> <p>Publish the following dynamic configuration via shell:</p> <div class="language-properties extra-class"><pre class="language-properties"><code><span class="token key attr-name">curl</span> <span class="token value attr-value">-d 'dataId=demo' \
  -d 'group=app:default' \
  -d 'namespaceId=default' \
  -d 'content=test' \
  -X POST 'http://ip:port/nacos/v2/cs/config'</span>
</code></pre></div><p>Where <code>app=default</code> is the value of the legalized group, <code>demo</code> is the key, and <code>test</code> is the value, and the <code>default</code> is
<code>service.meta.project</code> in
<code>agent/config/config.properties</code>.</p> <p>When the node data is successfully created, the dynamic configuration is successfully published in the configuration center.</p> <h4 id="validation-3"><a href="#validation-3" class="header-anchor">#</a> Validation</h4> <p>Check out the sermant log file sermant-0.log. The default log file path is <code>./logs/sermant/core</code>.</p> <p>Observe if the log file contains the following log output:</p> <div class="language- extra-class"><pre class="language-text"><code>[DemoDynaConfService]-DynamicConfigEvent{key='demo', group='app:default', content='test', eventType=CREATE} io.sermant.core.service.dynamicconfig.common.DynamicConfigEvent[source=demo,app=default]
</code></pre></div><p>If the log output is correct, it means that the dynamic configuration is published successfully and the sermant-agent has listened to the dynamic configuration.</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">9/12/2024, 2:34:52 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/en/document/user-guide/sermant-backend.html" class="prev">
        Sermant Backend User Manual
      </a></span> <span class="next"><a href="/en/document/user-guide/sermant-xds.html">
        Proxyless Service Mesh Based on Sermant and Istio
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.7283d6fb.js" defer></script><script src="/assets/js/3.06f127bc.js" defer></script><script src="/assets/js/1.c8bacf5b.js" defer></script><script src="/assets/js/59.255861a7.js" defer></script><script src="/assets/js/14.199c38f6.js" defer></script>
  </body>
</html>
