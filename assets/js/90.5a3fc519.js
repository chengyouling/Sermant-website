(window.webpackJsonp=window.webpackJsonp||[]).push([[90],{537:function(a,t,e){"use strict";e.r(t);var s=e(26),n=Object(s.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"动态配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#动态配置"}},[a._v("#")]),a._v(" 动态配置")]),a._v(" "),t("p",[a._v("本文介绍如何使用"),t("a",{attrs:{href:"https://github.com/huaweicloud/Sermant/tree/develop/sermant-plugins/sermant-dynamic-config",target:"_blank",rel:"noopener noreferrer"}},[a._v("动态配置插件"),t("OutboundLink")],1),a._v("。")]),a._v(" "),t("h2",{attrs:{id:"功能介绍"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#功能介绍"}},[a._v("#")]),a._v(" 功能介绍")]),a._v(" "),t("p",[a._v("Spring Cloud Config动态配置已广泛应用于企业开发项目，为用户更方便使用配置中心，切换配置中心类型更便捷，动态配置插件基于Sermant动态配置中心的能力实现应用配置的动态更新。该插件可屏蔽应用原配置中心，应用在挂载Sermant运行时，通过动态配置中心对宿主应用的配置进行刷新。")]),a._v(" "),t("h2",{attrs:{id:"参数配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参数配置"}},[a._v("#")]),a._v(" 参数配置")]),a._v(" "),t("h3",{attrs:{id:"sermant-agent配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#sermant-agent配置"}},[a._v("#")]),a._v(" Sermant-agent配置")]),a._v(" "),t("p",[a._v("动态配置插件依赖动态配置中心，需要在Sermant-agent中配置动态配置中心的地址（"),t("code",[a._v("dynamic.config.serverAddress")]),a._v("），动态配置中心的类型（"),t("code",[a._v("dynamic.config.dynamicConfigType")]),a._v("）,具体参考"),t("RouterLink",{attrs:{to:"/zh/document/user-guide/sermant-agent.html#sermant-agent使用参数配置"}},[a._v("Sermant-agent使用手册")]),a._v("。")],1),a._v(" "),t("h3",{attrs:{id:"插件配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#插件配置"}},[a._v("#")]),a._v(" 插件配置")]),a._v(" "),t("p",[a._v("动态配置插件需打开是否开启适配CSE（"),t("code",[a._v("dynamic.config.plugin.enableCseAdapter")]),a._v("），是否开启动态配置插件（"),t("code",[a._v("dynamic.config.plugin.enableDynamicConfig")]),a._v("）等开关，可在"),t("code",[a._v("${path}/sermant-agent-x.x.x/agent/pluginPackage/dynamic-config/config/config.yaml")]),a._v("找到插件的配置文件，配置如下所示：")]),a._v(" "),t("div",{staticClass:"language-yaml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("dynamic.config.plugin")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("enableCseAdapter")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean important"}},[a._v("false")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 是否开启适配CSE")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("enableDynamicConfig")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean important"}},[a._v("true")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 是否开启动态配置插件")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("enableOriginConfigCenter")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean important"}},[a._v("false")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 是否开启原配置中心, 默认关闭")]),a._v("\n")])])]),t("table",[t("thead",[t("tr",[t("th",[a._v("参数键")]),a._v(" "),t("th",[a._v("说明")]),a._v(" "),t("th",[a._v("默认值")]),a._v(" "),t("th",[a._v("是否必须")])])]),a._v(" "),t("tbody",[t("tr",[t("td",[a._v("enableCseAdapter")]),a._v(" "),t("td",[a._v("是否开启适配CSE; "),t("br"),a._v(" "),t("strong",[a._v("true")]),a._v(":根据应用配置,服务配置,自定义标签配置进行配置订阅；"),t("br"),a._v(" "),t("strong",[a._v("false")]),a._v(":根据服务名进行订阅；"),t("RouterLink",{attrs:{to:"/zh/document/plugin/dynamic-config.html#详细治理规则"}},[a._v("见详细治理规则说明")])],1),a._v(" "),t("td",[a._v("true")]),a._v(" "),t("td",[a._v("是")])]),a._v(" "),t("tr",[t("td",[a._v("enableDynamicConfig")]),a._v(" "),t("td",[a._v("是否开启动态配置插件")]),a._v(" "),t("td",[a._v("false")]),a._v(" "),t("td",[a._v("否")])]),a._v(" "),t("tr",[t("td",[a._v("enableOriginConfigCenter")]),a._v(" "),t("td",[a._v("是否开启原配置中心; "),t("br"),a._v(" "),t("strong",[a._v("false")]),a._v(":屏蔽原配置中心，只能通过Sermant下发配置; "),t("br"),a._v(" "),t("strong",[a._v("true")]),a._v(":不屏蔽原配置中心，可通过原配置中心下发配置，"),t("strong",[a._v("注意")]),a._v("：若不屏蔽应用原配置中心可能会影响动态配置中心下发配置")]),a._v(" "),t("td",[a._v("false")]),a._v(" "),t("td",[a._v("否")])])])]),a._v(" "),t("h2",{attrs:{id:"详细治理规则"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#详细治理规则"}},[a._v("#")]),a._v(" 详细治理规则")]),a._v(" "),t("p",[a._v("动态配置插件基于框架提供的动态配置能力进行配置发布，配置发布可以参考"),t("RouterLink",{attrs:{to:"/zh/document/user-guide/configuration-center.html#发布配置"}},[a._v("动态配置中心使用手册")])],1),a._v(" "),t("p",[a._v("动态配置主要基于"),t("code",[a._v("group")]),a._v("进行匹配配置订阅，该标签组由多个键值对组成，根据适配开关配置"),t("code",[a._v("enableCseAdapter")]),a._v("的不同，"),t("code",[a._v("group")]),a._v("的值将会有所区别，如下：")]),a._v(" "),t("ul",[t("li",[t("p",[a._v("若关闭适配，即"),t("code",[a._v("enableCseAdapter: false")])]),a._v(" "),t("p",[a._v("此时插件将根据宿主应用的服务名进行订阅, 即应用配置的"),t("code",[a._v("spring.applicaton.name")]),a._v(", 插件订阅配置的group为"),t("code",[a._v("service=${spring.applicaton.name}")])])]),a._v(" "),t("li",[t("p",[a._v("若开启适配, 即"),t("code",[a._v("enableCseAdapter: true")])]),a._v(" "),t("p",[a._v("此时插件将根据"),t("strong",[a._v("应用配置")]),a._v("，"),t("strong",[a._v("服务配置")]),a._v("以及"),t("strong",[a._v("自定义配置")]),a._v("三项数据进行配置"),t("strong",[a._v("同时")]),a._v("订阅， 而这三类配置可参考"),t("code",[a._v("${path}/sermant-agent-x.x.x/agent/config/config.properties")]),a._v(", 相关配置如下：")]),a._v(" "),t("div",{staticClass:"language-properties extra-class"},[t("pre",{pre:!0,attrs:{class:"language-properties"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 服务app名称")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("service.meta.application")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("default")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 服务版本")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("service.meta.version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1.0.0")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# serviceComb 命名空间")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("service.meta.project")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("default")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 环境")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("service.meta.environment")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("development")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 自定义标签，按需配置，用于后续的配置订阅")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("service.meta.customLabel")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("public")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("service.meta.customLabelValue")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("default")]),a._v("\n")])])]),t("p",[a._v("应用配置，服务配置，自定义配置说明参考"),t("a",{attrs:{href:"https://support.huaweicloud.com/devg-cse/cse_devg_0020.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("CSE配置中心概述"),t("OutboundLink")],1)]),a._v(" "),t("ul",[t("li",[a._v("应用配置：由"),t("code",[a._v("service.meta.application")]),a._v("与"),t("code",[a._v("service.meta.environment")]),a._v("组成， 对应的"),t("code",[a._v("group")]),a._v("为"),t("code",[a._v("app=default&environment=development")])]),a._v(" "),t("li",[a._v("服务配置：由"),t("code",[a._v("service.meta.application")]),a._v("、"),t("code",[a._v("service.meta.environment")]),a._v("以及服务名组成，此处服务即"),t("code",[a._v("spring.application.name")]),a._v(", 对应的"),t("code",[a._v("group")]),a._v("为"),t("code",[a._v("app=default&environment=development&service=DynamicConfigDemo")])]),a._v(" "),t("li",[a._v("自定义配置：由"),t("code",[a._v("service.meta.customLabel")]),a._v("与"),t("code",[a._v("service.meta.customLabelValue")]),a._v("组成， 对应的"),t("code",[a._v("group")]),a._v("为"),t("code",[a._v("public=default")])])])])]),a._v(" "),t("p",[a._v("以上为"),t("code",[a._v("group")]),a._v("的配置介绍，下面说明"),t("code",[a._v("content")]),a._v("配置，当前动态配置仅支持yaml格式, 例如配置如下内容:")]),a._v(" "),t("div",{staticClass:"language-yaml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("server")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("port")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("8004")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("sermant")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" sermant\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("spring")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("application")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" DynamicConfigDemo\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("cloud")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("zookeeper")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("enabled")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean important"}},[a._v("true")]),a._v("\n")])])]),t("h2",{attrs:{id:"支持版本和限制"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#支持版本和限制"}},[a._v("#")]),a._v(" 支持版本和限制")]),a._v(" "),t("h3",{attrs:{id:"支持版本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#支持版本"}},[a._v("#")]),a._v(" 支持版本")]),a._v(" "),t("table",[t("thead",[t("tr",[t("th",[a._v("框架类型")]),a._v(" "),t("th",[a._v("版本")])])]),a._v(" "),t("tbody",[t("tr",[t("td",[a._v("SpringBoot")]),a._v(" "),t("td",[a._v("1.5.x - 2.6.2")])]),a._v(" "),t("tr",[t("td",[a._v("spring-cloud-starter-alibaba-nacos-config")]),a._v(" "),t("td",[a._v("1.5.0.RELEASE+")])]),a._v(" "),t("tr",[t("td",[a._v("spring-cloud-starter-zookeeper-config")]),a._v(" "),t("td",[a._v("1.2.0.RELEASE+")])])])]),a._v(" "),t("h3",{attrs:{id:"限制"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#限制"}},[a._v("#")]),a._v(" 限制")]),a._v(" "),t("ol",[t("li",[a._v("屏蔽应用原配置中心（目前仅支持"),t("strong",[a._v("zookeeper")]),a._v("，"),t("strong",[a._v("nacos")]),a._v("）")]),a._v(" "),t("li",[a._v("需配合注解"),t("code",[a._v("@Value, @ConfigurationProperties以及@RefreshScope")]),a._v("使用，以下示范"),t("code",[a._v("@Value")]),a._v("注解使用，"),t("code",[a._v("@ConfigurationProperties")]),a._v("注解同理")])]),a._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/**\n * @Value配置示范\n * 需配合注解@RefreshScope\n */")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Component")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@RefreshScope")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("class")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("ValueConfig")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Value")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"${sermant}"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Object")]),a._v(" sermant"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Value")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"${server.port}"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),a._v(" port"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Override")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("String")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("toString")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("return")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"ValueConfig{"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),a._v("\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"sermant="')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),a._v(" sermant "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),a._v("\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('", port="')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),a._v(" port "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token char"}},[a._v("'\\''")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),a._v("\n            "),t("span",{pre:!0,attrs:{class:"token char"}},[a._v("'}'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Object")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("getSermant")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("return")]),a._v(" sermant"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),t("h2",{attrs:{id:"操作和结果验证"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#操作和结果验证"}},[a._v("#")]),a._v(" 操作和结果验证")]),a._v(" "),t("p",[a._v("下面将演示如何使用动态配置插件，验证使用Sermant动态配置中心（ZooKeeper）更新SpringBoot应用配置的场景。")]),a._v(" "),t("h3",{attrs:{id:"准备工作"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#准备工作"}},[a._v("#")]),a._v(" 准备工作")]),a._v(" "),t("ul",[t("li",[a._v("[下载](https://github.com/huaweicloud/Sermant-examples/releases/download/v1.4.0/sermant-examples-dynamic-demo-1.4.0. tar.gz) Demo二进制产物压缩包")]),a._v(" "),t("li",[t("a",{attrs:{href:"https://github.com/huaweicloud/Sermant/releases/download/v1.4.0/sermant-1.4.0.tar.gz",target:"_blank",rel:"noopener noreferrer"}},[a._v("下载"),t("OutboundLink")],1),a._v(" Sermant Release包（当前版本推荐1.4.0版本）")]),a._v(" "),t("li",[t("a",{attrs:{href:"https://zookeeper.apache.org/releases#download",target:"_blank",rel:"noopener noreferrer"}},[a._v("下载"),t("OutboundLink")],1),a._v(" 并启动ZooKeeper")])]),a._v(" "),t("h3",{attrs:{id:"步骤一-获取demo二进制产物"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#步骤一-获取demo二进制产物"}},[a._v("#")]),a._v(" 步骤一：获取Demo二进制产物")]),a._v(" "),t("p",[a._v("解压Demo二进制产物压缩包，即可得到"),t("code",[a._v("spring-provider.jar")]),a._v("。")]),a._v(" "),t("h3",{attrs:{id:"步骤二-修改插件配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#步骤二-修改插件配置"}},[a._v("#")]),a._v(" 步骤二：修改插件配置")]),a._v(" "),t("p",[a._v("参考"),t("a",{attrs:{href:"#%E6%8F%92%E4%BB%B6%E9%85%8D%E7%BD%AE"}},[a._v("插件配置")]),a._v(" 修改"),t("code",[a._v("${path}/sermant-agent-x.x.x/agent/pluginPackage/dynamic-config/config/config.yaml")]),a._v("文件为以下内容：")]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("dynamic.config.plugin:\n  enableCseAdapter: "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("false")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 是否开启适配CSE")]),a._v("\n  enableDynamicConfig: "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 是否开启动态配置插件")]),a._v("\n  enableOriginConfigCenter: "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("false")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 是否开启原配置中心, 默认关闭")]),a._v("\n")])])]),t("blockquote",[t("p",[t("strong",[a._v("说明")]),a._v("：${path}为sermant所在路径。")])]),a._v(" "),t("h3",{attrs:{id:"步骤三-启动demo应用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#步骤三-启动demo应用"}},[a._v("#")]),a._v(" 步骤三：启动Demo应用")]),a._v(" "),t("p",[a._v("参考如下命令启动Demo应用")]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# windwos")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("java")]),a._v(" -javaagent:"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${path}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("sermant-agent-x.x.x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("agent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("sermant-agent.jar "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-Dspring.application.name")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("spring-flow-provider "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-Dspring.cloud.zookeeper.connectString")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("127.0")]),a._v(".0.1:2181 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-jar")]),a._v(" spring-provider.jar\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#linux mac")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("java")]),a._v(" -javaagent:"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${path}")]),a._v("/sermant-agent-x.x.x/agent/sermant-agent.jar "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-Dspring.application.name")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("spring-flow-provider "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-Dspring.cloud.zookeeper.connectString")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("127.0")]),a._v(".0.1:2181 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-jar")]),a._v(" spring-provider.jar\n")])])]),t("blockquote",[t("p",[t("strong",[a._v("说明：")]),a._v(" ${path}为sermant实际安装路径，x.x.x代表sermant某个版本号。")])]),a._v(" "),t("h3",{attrs:{id:"步骤四-查看原配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#步骤四-查看原配置"}},[a._v("#")]),a._v(" 步骤四：查看原配置")]),a._v(" "),t("p",[a._v("浏览器或curl工具访问"),t("code",[a._v("localhost:8003/flow")]),a._v(",查看控制台日志是否打印"),t("code",[a._v("sermant")]),a._v("日志")]),a._v(" "),t("p",[t("strong",[a._v("Demo应用配置")]),a._v("如下：")]),a._v(" "),t("div",{staticClass:"language-yaml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# Demo 应用配置")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("server")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("port")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("8003")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("sermant")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" sermant\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("spring")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("application")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" spring"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("flow"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("provider\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("cloud")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("zookeeper")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("enabled")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean important"}},[a._v("true")]),a._v("\n")])])]),t("p",[a._v("当调用"),t("strong",[a._v("flow接口")]),a._v('时，Demo应用将返回如下信息，此时返回sermant的值为"sermant"(该对象通过@value方式注入)：')]),a._v(" "),t("div",{staticClass:"language-text extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("Hello, I am zk rest template provider, my port is 8003, sermant value is sermant\n")])])]),t("h3",{attrs:{id:"步骤五-修改应用配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#步骤五-修改应用配置"}},[a._v("#")]),a._v(" 步骤五：修改应用配置")]),a._v(" "),t("p",[a._v("参考使用"),t("RouterLink",{attrs:{to:"/zh/document/user-guide/configuration-center.html#发布配置"}},[a._v("动态配置中心使用手册")]),a._v(" 进行配置发布")],1),a._v(" "),t("p",[a._v("以ZooKeeper为例，利用ZooKeeper提供的命令行工具来来发布动态配置：")]),a._v(" "),t("ol",[t("li",[a._v("在"),t("code",[a._v("${path}/bin/")]),a._v("目录执行以下命令创建节点"),t("code",[a._v("/service=spring-flow-provider")])])]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# linux mac")]),a._v("\n./zkCli.sh "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-server")]),a._v(" localhost:2181 create /service"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("spring-flow-provider\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# windows")]),a._v("\nzkCli.cmd "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-server")]),a._v(" localhost:2181 create /service"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("spring-flow-provider\n")])])]),t("ol",{attrs:{start:"2"}},[t("li",[a._v("在"),t("code",[a._v("${path}/bin/")]),a._v("目录执行以下命令创建创建节点"),t("code",[a._v("/service=spring-flow-provider/config")]),a._v("和数据"),t("code",[a._v("sermant: sermant1")])])]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# linux mac")]),a._v("\n./zkCli.sh "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-server")]),a._v(" localhost:2181 create /service"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("spring-flow-provider/config "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"sermant: sermant1"')]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# windows")]),a._v("\nzkCli.cmd "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-server")]),a._v(" localhost:2181 create /service"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("spring-flow-provider/config "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"sermant: sermant1"')]),a._v("\n")])])]),t("blockquote",[t("p",[a._v("说明：${path}为ZooKeeper的安装目录。")])]),a._v(" "),t("h3",{attrs:{id:"验证"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#验证"}},[a._v("#")]),a._v(" 验证")]),a._v(" "),t("p",[a._v("再次通过浏览器或curl工具访问"),t("code",[a._v("localhost:8003/flow")]),a._v('，Demo应用将返回如下信息，此时返回sermant的值为"sermant1"：')]),a._v(" "),t("div",{staticClass:"language-text extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("Hello, I am zk rest template provider, my port is 8003, sermant value is sermant1\n")])])])])}),[],!1,null,null,null);t.default=n.exports}}]);