(window.webpackJsonp=window.webpackJsonp||[]).push([[63],{509:function(t,a,s){"use strict";s.r(a);var e=s(26),n=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"sermant-agent-user-manual"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sermant-agent-user-manual"}},[t._v("#")]),t._v(" Sermant Agent User Manual")]),t._v(" "),a("p",[t._v("Sermant Agent is the core component providing bytecode enhancement capabilities and various service governance functionalities. The content under the "),a("code",[t._v("sermant-agent-x.x.x/agent")]),t._v(" directory described in the "),a("RouterLink",{attrs:{to:"/en/document/user-guide/"}},[t._v("Sermant Introduction")]),t._v(" outlines the modules of the Sermant Agent component. The main body of Sermant Agent offers foundational bytecode enhancement capabilities and a development framework, while also supporting essential features such as heartbeat functionality, dynamic configuration, logging, and event reporting. It currently supports both "),a("code",[t._v("premain")]),t._v(" and "),a("code",[t._v("agentmain")]),t._v("startup methods.")],1),t._v(" "),a("p",[t._v("The Sermant Agent plugin directory includes plugins that provide service governance capabilities such as tag routing, rate limiting and degradation, and dual registration. It now supports the dynamic installation and uninstallation of service governance plugins while the host service is running, provided the plugins support dynamic installation and uninstallation.")]),t._v(" "),a("h2",{attrs:{id:"supported-version"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#supported-version"}},[t._v("#")]),t._v(" Supported Version")]),t._v(" "),a("p",[t._v("Sermant Agent supports Linux and Windows, and is developed based on JDK 1.8. It is recommended to use JDK 1.8 or higher versions.")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://gitee.com/openeuler/bishengjdk-8",target:"_blank",rel:"noopener noreferrer"}},[t._v("HuaweiJDK 1.8"),a("OutboundLink")],1),t._v(" / "),a("a",{attrs:{href:"https://github.com/openjdk/jdk",target:"_blank",rel:"noopener noreferrer"}},[t._v("OpenJDK 1.8"),a("OutboundLink")],1),t._v(" / "),a("a",{attrs:{href:"https://www.oracle.com/java/technologies/downloads/",target:"_blank",rel:"noopener noreferrer"}},[t._v("OracleJDK 1.8"),a("OutboundLink")],1)])]),t._v(" "),a("h2",{attrs:{id:"premain-startup-static-attachment"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#premain-startup-static-attachment"}},[t._v("#")]),t._v(" Premain Startup: Static Attachment")]),t._v(" "),a("p",[t._v("To start Sermant Agent using the "),a("code",[t._v("premain")]),t._v(" method via static attachment, configure the host service with the "),a("code",[t._v("-javaagent")]),t._v("option. Based on the environment set up in the "),a("RouterLink",{attrs:{to:"/en/document/QuickStart.html"}},[t._v("Quick Start Guide")]),t._v(", execute the following command to launch Sermant Agent:")],1),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# linux mac")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("java")]),t._v(" -javaagent:"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${path}")]),t._v("/sermant-agent-x.x.x/agent/sermant-agent.jar "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-jar")]),t._v(" spring-provider.jar\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# windows")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("java")]),t._v(" -javaagent:"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${path}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("sermant-agent-x.x.x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("agent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("sermant-agent.jar "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-jar")]),t._v(" spring-provider.jar\n")])])]),a("p",[t._v("Check the beginning of the "),a("code",[t._v("spring-provider.jar")]),t._v(" log to see if it contains the following content:")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("xxxx-xx-xxTxx:xx:xx.xxx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Loading god library into BootstrapClassLoader.\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("xxxx-xx-xxTxx:xx:xx.xxx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Building argument map by agent arguments.\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("xxxx-xx-xxTxx:xx:xx.xxx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Loading core library into SermantClassLoader.\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("xxxx-xx-xxTxx:xx:xx.xxx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Loading sermant agent, artifact is: default\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("xxxx-xx-xxTxx:xx:xx.xxx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Load sermant done, artifact is: default\n")])])]),a("p",[t._v("If the log outputs as shown above, it indicates that Sermant Agent has started successfully. Open your browser and navigate to "),a("code",[t._v("http://localhost:8900")]),t._v(", where you should see a Sermant Agent instance. The expected result is shown in the image below:")]),t._v(" "),a("MyImage",{attrs:{src:"/docs-img/backend_sermant_info.jpg"}}),t._v(" "),a("h2",{attrs:{id:"agentmain-startup-dynamic-attachment"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#agentmain-startup-dynamic-attachment"}},[t._v("#")]),t._v(" Agentmain Startup：Dynamic Attachment")]),t._v(" "),a("h3",{attrs:{id:"agent-installation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#agent-installation"}},[t._v("#")]),t._v(" Agent Installation")]),t._v(" "),a("ul",[a("li",[t._v("Based on the environment set up in the "),a("RouterLink",{attrs:{to:"/en/document/QuickStart.html"}},[t._v("Quick Start Guide")]),t._v(", first start the host service "),a("code",[t._v("spring-provider.jar")]),t._v(".")],1)]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("java")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-jar")]),t._v(" spring-provider.jar\n")])])]),a("ul",[a("li",[t._v("To start by "),a("code",[t._v("agentmain")]),t._v(",  you need to use the "),a("code",[t._v("Attach API")]),t._v(". First, create a Java file using the "),a("a",{attrs:{href:"#attachments"}},[t._v("AgentLoader.java")]),t._v(" and compile it with "),a("code",[t._v("javac")]),t._v(":")])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Linux、MacOS")]),t._v("\njavac "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-cp")]),t._v(" ./:"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$JAVA_HOME")]),t._v("/lib/tools.jar AgentLoader.java\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Windows has correctly configured the environment variables required for JAVA.")]),t._v("\njavac "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-cp")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%JAVA_HOME%\\lib'),a("span",{pre:!0,attrs:{class:"token entity",title:"\\t"}},[t._v("\\t")]),t._v('ools.jar"')]),t._v(" AgentLoader.java "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-encoding")]),t._v(" utf-8\n")])])]),a("ul",[a("li",[t._v("After compilation, an "),a("code",[t._v("AgentLoader.class")]),t._v(" file will be generated in the directory. Run "),a("code",[t._v("AgentLoader")]),t._v(" using the following command:")])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Linux、MacOS")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("java")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-cp")]),t._v(" ./:"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$JAVA_HOME")]),t._v("/lib/tools.jar AgentLoader\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Windows has correctly configured the environment variables required for JAVA.")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("java")]),t._v(" AgentLoader\n")])])]),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Choose the command to run based on the operating system you are using. Below are the commands for Linux and MacOS:")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("java")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-cp")]),t._v(" ./:"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$JAVA_HOME")]),t._v("/lib/tools.jar AgentLoader\nPlease "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" the Java process you wish to use with Sermant Agent:\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(": xxxxx AgentLoader "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# xxxxx represents the process ID, which is obscured here.")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(": xxxxx spring-provider.jar "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# xxxxx represents the process ID, which is obscured here.")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(": xxxxx sermant-backend-1.2.0.jar "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# xxxxx represents the process ID, which is obscured here.")]),t._v("\nPlease enter the Java process number you wish to use with Sermant Agent: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Select the process number of spring-provider.")]),t._v("\nThe process ID you selected: xxxxx "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# xxxxx represents the process ID, which is obscured here.")]),t._v("\nPlease enter the directory where Sermant Agent is located "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("by default, it uses sermant-agent.jar "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" this directory as the entry point"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(": "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${path}")]),t._v("/sermant-agent-x.x.x/agent "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Enter the directory where Sermant Agent is located.")]),t._v("\nPlease enter the parameters to pass to Sermant Agent "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("can be empty, default configuration parameter is agentPath"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(": "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Configure Sermant Agent parameters (can be empty)")]),t._v("\n")])])]),a("p",[t._v("After completing the input according to the instructions, you can see the following content in the "),a("code",[t._v("spring-provider.jar")]),t._v("log:")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("xxxx-xx-xxTxx:xx:xx.xxx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Loading god library into BootstrapClassLoader.\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("xxxx-xx-xxTxx:xx:xx.xxx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Building argument map by agent arguments.\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("xxxx-xx-xxTxx:xx:xx.xxx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Loading core library into SermantClassLoader.\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("xxxx-xx-xxTxx:xx:xx.xxx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Loading sermant agent, artifact is: default\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("xxxx-xx-xxTxx:xx:xx.xxx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Load sermant done, artifact is: default\n")])])]),a("p",[t._v("If the log outputs as shown above, it indicates that Sermant Agent successfully read the startup command and began the installation. Open your browser and navigate to "),a("code",[t._v("http://localhost:8900")]),t._v(", where you should see a Sermant Agent instance. The expected result is shown in the image below:")]),t._v(" "),a("MyImage",{attrs:{src:"/docs-img/sermant-agent-agentmain-start.png"}}),t._v(" "),a("h3",{attrs:{id:"agent-uninstallation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#agent-uninstallation"}},[t._v("#")]),t._v(" Agent Uninstallation")]),t._v(" "),a("blockquote",[a("p",[t._v("Note: To avoid potential unpredictable exceptions when uninstalling service governance capabilities developed based on the premain startup method, Sermant Agent imposes restrictions on uninstallation. Only Sermant Agents started via the agentmain method support uninstallation; those started via the premain method do not support uninstallation.")])]),t._v(" "),a("p",[t._v("After "),a("a",{attrs:{href:"#agent-installation"}},[t._v("dynamically attaching the Agent")]),t._v(", you can uninstall Agent. Run "),a("code",[t._v("AgentLoader")]),t._v(" again and pass the parameter to issue the uninstall command for Sermant Agent using "),a("code",[t._v("command=UNINSTALL-AGENT")]),t._v(":")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Choose the command to run based on the operating system you are using. Below are the commands for Linux and MacOS:")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("java")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-cp")]),t._v(" ./:"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$JAVA_HOME")]),t._v("/lib/tools.jar AgentLoader\nPlease "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" the Java process you wish to use with Sermant Agent:\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(": xxxxx AgentLoader "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# xxxxx represents the process ID, which is obscured here.")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(": xxxxx spring-provider.jar "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# xxxxx represents the process ID, which is obscured here.")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(": xxxxx sermant-backend-1.2.0.jar "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# xxxxx represents the process ID, which is obscured here.")]),t._v("\nPlease enter the Java process number you wish to use with Sermant Agent: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Select the process number of spring-provider.")]),t._v("\nThe process ID you selected: xxxxx "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# xxxxx represents the process ID, which is obscured here.")]),t._v("\nPlease enter the directory where Sermant Agent is located "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("by default, it uses sermant-agent.jar "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" this directory as the entry point"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(": "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${path}")]),t._v("/sermant-agent-x.x.x/agent "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Enter the directory where Sermant Agent is located.")]),t._v("\nPlease enter the parameters to pass to Sermant Agent "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("can be empty, default configuration parameter is agentPath"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(":command"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("UNINSTALL-AGENT "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Pass the parameter here to issue the uninstall command.")]),t._v("\n")])])]),a("p",[t._v("After completing the input according to the instructions, you can see the following content in the "),a("code",[t._v("spring-provider.jar")]),t._v("log:")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("xxxx-xx-xxTxx:xx:xx.xxx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Building argument map by agent arguments.\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("xxxx-xx-xxTxx:xx:xx.xxx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Sermant "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" artifact is running, artifact is: default\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("xxxx-xx-xxTxx:xx:xx.xxx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Execute command: UNINSTALL-AGENT\n")])])]),a("p",[t._v("If the log outputs as shown above, open your browser and navigate to "),a("code",[t._v("http://localhost:8900")]),t._v(". You should see that the Sermant Agent instance has been shut down ("),a("strong",[t._v("status is gray")]),t._v("), indicating that Sermant Agent has been successfully uninstalled. The expected result is shown in the image below:")]),t._v(" "),a("MyImage",{attrs:{src:"/docs-img/sermant-agent-agentmain-uninstall-success.png"}}),t._v(" "),a("blockquote",[a("p",[t._v("Note: This capability can be implemented in the development mode by calling the "),a("code",[t._v("uninstall")]),t._v(" interface provided by "),a("a",{attrs:{href:"https://github.com/sermant-io/Sermant/blob/develop/sermant-agentcore/sermant-agentcore-core/src/main/java/io/sermant/core/AgentCoreEntrance.java",target:"_blank",rel:"noopener noreferrer"}},[t._v("AgentCoreEntrance"),a("OutboundLink")],1),t._v(" in the sermant-agentcore-core module.")])]),t._v(" "),a("h3",{attrs:{id:"dynamic-plugin-installation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dynamic-plugin-installation"}},[t._v("#")]),t._v(" Dynamic Plugin Installation")]),t._v(" "),a("p",[t._v("After "),a("a",{attrs:{href:"#agent-installation"}},[t._v("dynamically attaching the Agent")]),t._v(", you can dynamically install service governance plugins (provided the plugins support dynamic installation and uninstallation). Run "),a("code",[t._v("AgentLoader")]),t._v(" again and pass the parameter to issue the dynamic plugin installation command using "),a("code",[t._v("command=INSTALL-PLUGINS:pluginA/pluginB")]),t._v(":")]),t._v(" "),a("blockquote",[a("p",[t._v("Note: Multiple plugins can be installed at once, separated by '/'. "),a("code",[t._v("pluginA")]),t._v(" and "),a("code",[t._v("pluginB")]),t._v(" are placeholders for actual plugin names. In this example, we use the "),a("RouterLink",{attrs:{to:"/en/document/plugin/monitor.html"}},[t._v("monitor")]),t._v(" plugin.")],1)]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Choose the command to run based on the operating system you are using. Below are the commands for Linux and MacOS:")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("java")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-cp")]),t._v(" ./:"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$JAVA_HOME")]),t._v("/lib/tools.jar AgentLoader\nPlease "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" the Java process you wish to use with Sermant Agent:\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(": xxxxx AgentLoader "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# xxxxx represents the process ID, which is obscured here.")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(": xxxxx spring-provider.jar "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# xxxxx represents the process ID, which is obscured here.")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(": xxxxx sermant-backend-1.2.0.jar "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# xxxxx represents the process ID, which is obscured here.")]),t._v("\nPlease enter the Java process number you wish to use with Sermant Agent: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Select the process number of spring-provider.")]),t._v("\nThe process ID you selected: xxxxx "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# xxxxx represents the process ID, which is obscured here.")]),t._v("\nPlease enter the directory where Sermant Agent is located "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("by default, it uses sermant-agent.jar "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" this directory as the entry point"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(": "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${path}")]),t._v("/sermant-agent-x.x.x/agent "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Enter the directory where Sermant Agent is located.")]),t._v("\nPlease enter the parameters to pass to Sermant Agent "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("can be empty, default configuration parameter is agentPath"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(":command"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("INSTALL-PLUGINS:monitor "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Pass the parameter here to issue the install plugin command. This example demonstrates using the monitor plugin.")]),t._v("\n")])])]),a("p",[t._v("After completing the input according to the instructions, you can see the following content in the "),a("code",[t._v("spring-provider.jar")]),t._v("log:")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("xxxx-xx-xxTxx:xx:xx.xxx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Building argument map by agent arguments.\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("xxxx-xx-xxTxx:xx:xx.xxx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Sermant "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" artifact is running, artifact is: default\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("xxxx-xx-xxTxx:xx:xx.xxx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Execute command: INSTALL-PLUGINS:monitor "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# This example demonstrates using the monitor plugin.")]),t._v("\n")])])]),a("p",[t._v("If the log outputs as shown above, it indicates that the plugin was installed successfully. Open your browser and navigate to "),a("code",[t._v("http://localhost:8900")]),t._v(", where you should see that the plugin has been successfully installed. The plugins list will display the currently installed plugins, as shown in the image below:")]),t._v(" "),a("p",[a("strong",[t._v("Before dynamically installing plugin")])]),t._v(" "),a("MyImage",{attrs:{src:"/docs-img/sermant-agent-dynamic-install-plugin-before.png"}}),t._v(" "),a("p",[a("strong",[t._v("After dynamically installing plugin")])]),t._v(" "),a("MyImage",{attrs:{src:"/docs-img/sermant-agent-dynamic-install-plugin-success.png"}}),t._v(" "),a("blockquote",[a("p",[t._v("Note: This capability can be implemented in the development mode by calling the "),a("code",[t._v("install(Set pluginNames)")]),t._v(" method provided by "),a("a",{attrs:{href:"https://github.com/sermant-io/Sermant/blob/develop/sermant-agentcore/sermant-agentcore-core/src/main/java/io/sermant/core/plugin/PluginManager.java",target:"_blank",rel:"noopener noreferrer"}},[t._v("PluginManager"),a("OutboundLink")],1),t._v(" in the sermant-agentcore-core module.")])]),t._v(" "),a("h3",{attrs:{id:"repeated-plugin-installation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#repeated-plugin-installation"}},[t._v("#")]),t._v(" Repeated Plugin Installation")]),t._v(" "),a("p",[t._v("The introduction of this capability is mainly due to the need for dynamically extending the effective scope of plugins in certain scenarios, primarily expanding the enhanced classes and methods, while ensuring that the already effective parts remain unaffected. In such cases, uninstalling and reinstalling plugins after adjusting configurations cannot address the issue.For example, in fault injection scenarios, different faults may require bytecode enhancement for different classes, and various fault scenarios need to be gradually injected according to the test plan's orchestration. In such cases, we cannot complete this task by uninstalling and reinstalling the plugin. Instead, we must install the fault injection plugin multiple times to solve this problem. This requires the capability of repeated plugin installation. Repeated plugin installation will reuse static resources, and Sermant internally isolates the repeatedly installed plugins through plugin management.")]),t._v(" "),a("h3",{attrs:{id:"how-to-implement-repeated-plugin-installation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-to-implement-repeated-plugin-installation"}},[t._v("#")]),t._v(" How to Implement Repeated Plugin Installation?")]),t._v(" "),a("p",[t._v("To install plugins repeatedly, you need to add a unique identifier to the plugin name using the "),a("code",[t._v("#")]),t._v(" symbol when performing dynamic plugin installation. For example:")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("command")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("INSTALL-PLUGINS:pluginA"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#FIRST")]),t._v("\n")])])]),a("p",[t._v("In this way, the plugin can be installed repeatedly.")]),t._v(" "),a("blockquote",[a("p",[t._v("Note: When uninstalling a plugin, if you want to uninstall a plugin that was installed with an identifier, you need to specify the plugin name with the identifier in the uninstall command as well.")])]),t._v(" "),a("h3",{attrs:{id:"dynamic-plugin-uninstallation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dynamic-plugin-uninstallation"}},[t._v("#")]),t._v(" Dynamic Plugin Uninstallation")]),t._v(" "),a("p",[t._v("After "),a("a",{attrs:{href:"#agent-installation"}},[t._v("dynamically attaching the Agent")]),t._v(" and "),a("a",{attrs:{href:"#dynamic-plugin-installation"}},[t._v("dynamically installing the plugin")]),t._v(", you can dynamically uninstall service governance plugins (provided the plugins support dynamic installation and uninstallation). Run "),a("code",[t._v("AgentLoader")]),t._v(" again and pass the parameter to issue the dynamic plugin uninstallation command using "),a("code",[t._v("command=UNINSTALL-PLUGINS:pluginA/pluginB")]),t._v(":")]),t._v(" "),a("blockquote",[a("p",[t._v("Note: Multiple plugins can be uninstalled at once, separated by '/'. "),a("code",[t._v("pluginA")]),t._v(" and "),a("code",[t._v("pluginB")]),t._v(" are placeholders for actual plugin names. In this example, we use the "),a("RouterLink",{attrs:{to:"/en/document/plugin/monitor.html"}},[t._v("monitor")]),t._v(" plugin.")],1)]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Choose the command to run based on the operating system you are using. Below are the commands for Linux and MacOS:")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("java")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-cp")]),t._v(" ./:"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$JAVA_HOME")]),t._v("/lib/tools.jar AgentLoader\nPlease "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" the Java process you wish to use with Sermant Agent:\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(": xxxxx AgentLoader "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# xxxxx represents the process ID, which is obscured here.")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(": xxxxx spring-provider.jar "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# xxxxx represents the process ID, which is obscured here.")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(": xxxxx sermant-backend-1.2.0.jar "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# xxxxx represents the process ID, which is obscured here.")]),t._v("\nPlease enter the Java process number you wish to use with Sermant Agent: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Select the process number of spring-provider.")]),t._v("\nThe process ID you selected: xxxxx "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# xxxxx represents the process ID, which is obscured here.")]),t._v("\nPlease enter the directory where Sermant Agent is located "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("by default, it uses sermant-agent.jar "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" this directory as the entry point"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(": "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${path}")]),t._v("/sermant-agent-x.x.x/agent "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Enter the directory where Sermant Agent is located.")]),t._v("\nPlease enter the parameters to pass to Sermant Agent "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("can be empty, default configuration parameter is agentPath"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(":command"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("UNINSTALL-PLUGINS:monitor "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Pass the parameter here to issue the uninstall plugin command.")]),t._v("\n")])])]),a("p",[t._v("After completing the input according to the instructions, you can see the following content in the "),a("code",[t._v("spring-provider.jar")]),t._v("log:")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("xxxx-xx-xxTxx:xx:xx.xxx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Building argument map by agent arguments.\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("xxxx-xx-xxTxx:xx:xx.xxx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Sermant "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" artifact is running, artifact is: default\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("xxxx-xx-xxTxx:xx:xx.xxx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Execute command: UNINSTALL-PLUGINS:monitor "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#This example demonstrates using "monitor" plugin.')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The log will show how many bytecode-enhanced classes were restored during the uninstallation.")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Byte Buddy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" REDEFINE BATCH "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#0 [1 of 1 type(s)]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Byte Buddy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" REDEFINE COMPLETE "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" batch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("es"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" containing "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" types "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" failed batch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("es"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Byte Buddy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" REDEFINE COMPLETE "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" batch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("es"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" containing "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" types "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" failed batch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("es"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("p",[t._v("If the log outputs as shown above, open your browser and navigate to "),a("code",[t._v("http://localhost:8900")]),t._v(". You should see that the plugin has been successfully uninstalled. The plugins list will display the currently installed plugins, as shown in the image below:")]),t._v(" "),a("p",[a("strong",[t._v("Before dynamically installing plugin")])]),t._v(" "),a("MyImage",{attrs:{src:"/docs-img/sermant-agent-dynamic-uninstall-plugin-before.png"}}),t._v(" "),a("p",[a("strong",[t._v("After dynamically installing plugin")])]),t._v(" "),a("MyImage",{attrs:{src:"/docs-img/sermant-agent-dynamic-uninstall-plugin-success.png"}}),t._v(" "),a("blockquote",[a("p",[t._v("Note: This capability can be implemented in development mode by calling the "),a("code",[t._v("uninstall(Set pluginNames)")]),t._v(" method provided by "),a("a",{attrs:{href:"https://github.com/sermant-io/Sermant/blob/develop/sermant-agentcore/sermant-agentcore-core/src/main/java/io/sermant/core/plugin/PluginManager.java",target:"_blank",rel:"noopener noreferrer"}},[t._v("PluginManager"),a("OutboundLink")],1),t._v(" in the sermant-agentcore-core module.")])]),t._v(" "),a("h3",{attrs:{id:"one-click-agent-and-plugin-attachment"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#one-click-agent-and-plugin-attachment"}},[t._v("#")]),t._v(" One-Click Agent and Plugin Attachment")]),t._v(" "),a("p",[t._v("The "),a("a",{attrs:{href:"https://github.com/sermant-io/Sermant/blob/develop/scripts/attach.c",target:"_blank",rel:"noopener noreferrer"}},[t._v("Sermant Dynamic Installation and Uninstallation Script"),a("OutboundLink")],1),t._v(" is a C language script based on the Java Attach API. It can attach Sermant Agent to JVM processes on either "),a("strong",[t._v("virtual machines")]),t._v(" or "),a("strong",[t._v("containers")]),t._v(".")]),t._v(" "),a("blockquote",[a("p",[t._v("Note: This script is only for use on "),a("strong",[t._v("Linux systems")]),t._v(".")])]),t._v(" "),a("h4",{attrs:{id:"parameter-configuration"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#parameter-configuration"}},[t._v("#")]),t._v(" Parameter Configuration")]),t._v(" "),a("ul",[a("li",[a("p",[a("code",[t._v("-path=")]),t._v("：required parameter, followed by the "),a("strong",[t._v("absolute path")]),t._v(" of sermant-agent.jar.")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("-pid=")]),t._v("：required parameter, followed by the PID of the host microservice, which can be found using commands like "),a("code",[t._v("ps -ef")]),t._v(".")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("-command=")]),t._v("：required parameter, followed by the command to attach Sermant Agent. Supported commands can be found in the "),a("a",{attrs:{href:"#sermant-command-instructions"}},[t._v("Sermant Command Instructions")]),t._v(".")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("-nspid=")]),t._v("：when the host microservice is running in a container, this parameter is required and should be followed by the host microservice's nspid, which can be found using the "),a("code",[t._v("cat /proc/{pid}/status")]),t._v(" command. If the host microservice is not running in a container, do not include this parameter.")])])]),t._v(" "),a("h4",{attrs:{id:"script-usage-steps"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#script-usage-steps"}},[t._v("#")]),t._v(" Script Usage Steps")]),t._v(" "),a("h5",{attrs:{id:"step-1-compile-jvm-attach-c"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#step-1-compile-jvm-attach-c"}},[t._v("#")]),t._v(" Step 1. Compile "),a("code",[t._v("jvm_attach.c")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("gcc attach.c "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-o")]),t._v(" attach\n")])])]),a("blockquote",[a("p",[t._v("Note: Please ensure that "),a("code",[t._v("gcc")]),t._v(" is already installed.")])]),t._v(" "),a("h5",{attrs:{id:"step-2-execute-the-attach-script"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#step-2-execute-the-attach-script"}},[t._v("#")]),t._v(" Step 2. Execute the Attach Script")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("./attach "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-path")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("sermant-path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("/sermant-agent.jar "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-pid")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("pid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-command")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("COMMAND"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("The script execution will display as follows:")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@b6b9af8e5610 root"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ./attach -path=/home/sermant-agent-1.0.0/agent/sermant-agent.jar -pid=494 -command=INSTALL-PLUGINS:database-write-prohibition")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(": "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("PATH")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" /home/sermant-agent-1.0.0/agent/sermant-agent.jar\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(": PID: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("494")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(": COMMAND: INSTALL-PLUGINS:database-write-prohibition\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(": Connected to remote JVM of pid "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("494")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(": ret code is "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(", Attach success"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\n")])])]),a("h2",{attrs:{id:"enhancement-information-query"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#enhancement-information-query"}},[t._v("#")]),t._v(" Enhancement Information Query")]),t._v(" "),a("p",[t._v("After Sermant has been successfully started by any method, you can run "),a("code",[t._v("AgentLoader")]),t._v(" and pass the parameter to issue the query enhancement information command using "),a("code",[t._v("command=CHECK_ENHANCEMENT")]),t._v(":")]),t._v(" "),a("blockquote",[a("p",[t._v("Note: The enhancement information query will be printed to the log at the "),a("strong",[t._v("INFO level")]),t._v(". If you use this feature, please configure the log level in advance. For modification instructions, see "),a("RouterLink",{attrs:{to:"/en/document/developer-guide/log-func.html#configuration"}},[t._v("Log Configuration")])],1)]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Choose the command to run based on the operating system you are using. Below are the commands for Linux and MacOS:")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("java")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-cp")]),t._v(" ./:"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$JAVA_HOME")]),t._v("/lib/tools.jar AgentLoader\nPlease "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" the Java process you wish to use with Sermant Agent:\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(": xxxxx AgentLoader "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# xxxxx represents the process ID, which is obscured here.")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(": xxxxx spring-provider.jar "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# xxxxx represents the process ID, which is obscured here.")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(": xxxxx sermant-backend-1.2.0.jar "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# xxxxx represents the process ID, which is obscured here.")]),t._v("\nPlease enter the Java process number you wish to use with Sermant Agent: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Select the process number of spring-provider.")]),t._v("\nThe process ID you selected: xxxxx "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# xxxxx represents the process ID, which is obscured here.")]),t._v("\nPlease enter the directory where Sermant Agent is located "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("by default, it uses sermant-agent.jar "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" this directory as the entry point"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(": "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${path}")]),t._v("/sermant-agent-x.x.x/agent "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Enter the directory where Sermant Agent is located.")]),t._v("\nPlease enter the parameters to pass to Sermant Agent "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("can be empty, default configuration parameter is agentPath"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(":command"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("CHECK_ENHANCEMENT "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Pass the parameter here to issue the query enhancement information command.")]),t._v("\n")])])]),a("p",[t._v("After completing the input according to the instructions, you can see the following content in the Sermant log:")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("xxxx-xx-xx xx:xx:xx.xxx "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("io.sermant.core.command.CheckEnhancementsCommandExecutor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("execute:42"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Attach Listener"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" ---------- PLUGINS ----------\nxxxx-xx-xx xx:xx:xx.xxx "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("io.sermant.core.command.CheckEnhancementsCommandExecutor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("execute:44"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Attach Listener"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" test-plugin-A:1.0.0\nxxxx-xx-xx xx:xx:xx.xxx "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("io.sermant.core.command.CheckEnhancementsCommandExecutor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("execute:44"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Attach Listener"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" test-plugin-B:1.0.0\nxxxx-xx-xx xx:xx:xx.xxx "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("io.sermant.core.command.CheckEnhancementsCommandExecutor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("execute:46"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Attach Listener"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" ---------- ENHANCEMENT ----------\nxxxx-xx-xx xx:xx:xx.xxx "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("io.sermant.core.command.CheckEnhancementsCommandExecutor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("execute:58"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Attach Listener"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" test-plugin-A:1.0.0\nxxxx-xx-xx xx:xx:xx.xxx "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("io.sermant.core.command.CheckEnhancementsCommandExecutor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("execute:65"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Attach Listener"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" xxxxx.xxxx.TestClassA"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#testFunctionA(boolean,java.lang.String,java.lang.String,java.lang.String)@sun.misc.Launcher$AppClassLoader@5c647e05 [xxxx.xxxx.TestInterceptorA]")]),t._v("\nxxxx-xx-xx xx:xx:xx.xxx "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("io.sermant.core.command.CheckEnhancementsCommandExecutor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("execute:65"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Attach Listener"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" xxxxx.xxxx.TestClassB"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#testFunctionB(boolean,java.lang.String,java.lang.String,java.lang.String)@sun.misc.Launcher$AppClassLoader@5c647e05 [xxxx.xxxx.TestInterceptorB,xxxx.xxxx.TestInterceptorC]")]),t._v("\n")])])]),a("p",[t._v("The format of the printed content is as follows:")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("---------- PLUGINS ----------\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(" List of installed plugins, formatted as: PluginName: PluginVersion\ntest-plugin-A:1.0.0\ntest-plugin-B:1.0.0\n---------- ENHANCEMENT ----------\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(" Plugins that successfully completed enhancement processing, formatted as: PluginName: PluginVersion\ntest-plugin-A:1.0.0\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(" Information on plugins that successfully completed enhancement processing:\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(" Formatted as: EnhancedFullQualifiedClassName"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#EnhancedMethodName(ParameterType)@ClassLoaderInformation [InterceptorList]")]),t._v("\nxxxxx.xxxx.TestClassA"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#testFunctionA(boolean,java.lang.String,java.lang.String,java.lang.String)@sun.misc.Launcher$AppClassLoader@5c647e05 [xxxx.xxxx.TestInterceptorA]")]),t._v("\nxxxxx.xxxx.TestClassB"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#testFunctionB(boolean,java.lang.String,java.lang.String,java.lang.String)@sun.misc.Launcher$AppClassLoader@5c647e05 [xxxx.xxxx.TestInterceptorB,xxxx.xxxx.TestInterceptorC]")]),t._v("\n")])])]),a("h2",{attrs:{id:"sermant-command-instructions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sermant-command-instructions"}},[t._v("#")]),t._v(" Sermant Command Instructions")]),t._v(" "),a("p",[t._v("Sermant can achieve hot-plugging capabilities by running "),a("code",[t._v("AgentLoader")]),t._v(" and passing in the following commands. Additionally, after Sermant Agent has been successfully started by any method, you can run "),a("code",[t._v("AgentLoader")]),t._v(" and pass in commands to query enhancement information. The specific commands are as follows:")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Command Type")]),t._v(" "),a("th",[t._v("Command Example")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("Agent Installation")]),t._v(" "),a("td",[t._v("If the command is empty, it defaults to Agent installation.")])]),t._v(" "),a("tr",[a("td",[t._v("Agent Uninstallation")]),t._v(" "),a("td",[t._v("command=UNINSTALL-AGENT")])]),t._v(" "),a("tr",[a("td",[t._v("Plugin Installation")]),t._v(" "),a("td",[t._v("command=INSTALL-PLUGINS:${PluginName}")])]),t._v(" "),a("tr",[a("td",[t._v("Plugin Uninstallation")]),t._v(" "),a("td",[t._v("command=UNINSTALL-PLUGINS:${PluginName}")])]),t._v(" "),a("tr",[a("td",[t._v("Repeated Plugin Installation")]),t._v(" "),a("td",[t._v("command=INSTALL-PLUGINS:${PluginName}#${CustomPluginIdentifier}")])]),t._v(" "),a("tr",[a("td",[t._v("Enhancement Information Query")]),t._v(" "),a("td",[t._v("command=CHECK_ENHANCEMENT")])])])]),t._v(" "),a("h2",{attrs:{id:"configuration-specifications"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#configuration-specifications"}},[t._v("#")]),t._v(" Configuration Specifications")]),t._v(" "),a("p",[t._v("The properties configuration files of the Sermant project and the YAML configuration files of each plugin support the following parameter configuration methods. For example, in the configuration file, "),a("code",[t._v("gateway.nettyIp=127.0.0.1")]),t._v(":")]),t._v(" "),a("ol",[a("li",[t._v("Directly modify the configuration file by changing "),a("code",[t._v("gateway.nettyIp=127.0.0.1")]),t._v(" in the file.")]),t._v(" "),a("li",[t._v("Configure it via the -D parameter when starting the microservice, i.e., "),a("code",[t._v("-Dgateway.nettyIp=127.0.0.1")]),t._v(".")]),t._v(" "),a("li",[t._v("Configure it via an environment variable by adding "),a("code",[t._v("gateway.nettyIp=127.0.0.1")]),t._v(" to the environment variables.")]),t._v(" "),a("li",[t._v("Configure it via Sermant Agent startup parameters, i.e., "),a("code",[t._v("-javaagent:sermant-agent.jar=gateway.nettyIp=127.0.0.1")]),t._v(".")])]),t._v(" "),a("p",[t._v("The four methods listed above, arranged in order of priority from highest to lowest, are: 4 > 3 > 2 > 1.")]),t._v(" "),a("p",[t._v("Among these, the values for the last three parameter configuration methods support multiple formats. For example, for "),a("code",[t._v("gateway.nettyIp=127.0.0.1")]),t._v(" in the configuration file, the following formats are all recognizable:")]),t._v(" "),a("div",{staticClass:"language-properties extra-class"},[a("pre",{pre:!0,attrs:{class:"language-properties"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("gateway.nettyIp")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("127.0.0.1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("gateway_nettyIp")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("127.0.0.1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("gateway-nettyIp")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("127.0.0.1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("GATEWAY.NETTYIP")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("127.0.0.1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("GATEWAY_NETTYIP")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("127.0.0.1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("GATEWAY-NETTYIP")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("127.0.0.1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("gateway.nettyip")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("127.0.0.1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("gateway_nettyip")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("127.0.0.1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("gateway-nettyip")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("127.0.0.1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("gateway.netty.ip")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("127.0.0.1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("gateway_netty_ip")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("127.0.0.1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("gateway-netty-ip")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("127.0.0.1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("GATEWAY.NETTY.IP")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("127.0.0.1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("GATEWAY_NETTY_IP")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("127.0.0.1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("GATEWAY-NETTY-IP")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("127.0.0.1")]),t._v("\n")])])]),a("p",[t._v("The Sermant Agent will sequentially check each configuration value from top to bottom to see if it is configured via startup parameters, environment variables, or -D parameters.")]),t._v(" "),a("blockquote",[a("p",[a("strong",[t._v("Note:")]),t._v(" When modifying configurations through container scenarios using "),a("code",[t._v("env")]),t._v(", replace point (.) with underscore (_).")]),t._v(" "),a("p",[t._v("Reason: Some OS images cannot recognize "),a("code",[t._v("env")]),t._v(" variables with point.")])]),t._v(" "),a("p",[t._v("For example：To modify the configuration "),a("code",[t._v("gateway.nettyIp=127.0.0.1")]),t._v(" through the pod's "),a("code",[t._v("env")]),t._v(", use:")]),t._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[t._v("  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("env")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"gateway_nettyIp"')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("value")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"127.0.0.2"')]),t._v("\n")])])]),a("h2",{attrs:{id:"attachments"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#attachments"}},[t._v("#")]),t._v(" Attachments")]),t._v(" "),a("h3",{attrs:{id:"agentloader-java"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#agentloader-java"}},[t._v("#")]),t._v(" AgentLoader.java")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token import"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("com"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sun"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tools"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("attach"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AgentInitializationException")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token import"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("com"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sun"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tools"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("attach"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AgentLoadException")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token import"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("com"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sun"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tools"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("attach"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AttachNotSupportedException")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token import"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("com"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sun"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tools"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("attach"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("VirtualMachine")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token import"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("com"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sun"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tools"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("attach"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("VirtualMachineDescriptor")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token import"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("io"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BufferedReader")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token import"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("io"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IOException")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token import"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("io"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("InputStreamReader")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token import"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("util"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AgentLoader")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AgentLoader")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n     * AgentLoader main method\n     */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throws")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IOException")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AttachNotSupportedException")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AgentLoadException")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AgentInitializationException")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("VirtualMachineDescriptor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" vmDescriptors "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("VirtualMachine")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("list")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vmDescriptors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("isEmpty")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"not find Java process"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Please select the Java process you wish to use with Sermant Agent: "')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" vmDescriptors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("VirtualMachineDescriptor")]),t._v(" descriptor "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" vmDescriptors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('": "')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" descriptor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("id")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('" "')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" descriptor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("displayName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Read the user-inputted number")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BufferedReader")]),t._v(" userInputReader "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BufferedReader")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("InputStreamReader")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("in"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Please enter the Java process number you wish to use with Sermant Agent: "')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" selectedProcessIndex "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Integer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("parseInt")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("userInputReader"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("readLine")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("selectedProcessIndex "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" selectedProcessIndex "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" vmDescriptors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Invalid process ID"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Connect to the selected virtual machine")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("VirtualMachineDescriptor")]),t._v(" selectedDescriptor "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" vmDescriptors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("selectedProcessIndex"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"The process ID you selected: "')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" selectedDescriptor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("id")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("VirtualMachine")]),t._v(" vm "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("VirtualMachine")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("attach")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("selectedDescriptor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Get the Sermant Agent directory")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Please enter the directory where Sermant Agent is located (by default, it uses sermant-agent.jar in this directory as the entry point): "')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" agentPath "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" userInputReader"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("readLine")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Get the parameters passed to the Sermant Agent")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Please enter the parameters to pass to Sermant Agent (can be empty, default configuration parameter is agentPath):"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" agentArgs "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"agentPath="')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" agentPath "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('","')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" userInputReader"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("readLine")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Close resource")]),t._v("\n        userInputReader"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("close")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Start Sermant Agent")]),t._v("\n        vm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("loadAgent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("agentPath "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/sermant-agent.jar"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" agentArgs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        vm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("detach")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])],1)}),[],!1,null,null,null);a.default=n.exports}}]);